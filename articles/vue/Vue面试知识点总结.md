## å‰è¨€

è¿™æ¬¡æ¢³ç†çš„æ˜¯vueç›¸å…³çš„çŸ¥è¯†ç‚¹ï¼Œæ•´ç†çš„æ˜¯è‡ªå·±ä¸å¤ªæ¸…æ¥šçš„ç‚¹ï¼Œéš¾æ˜“ç¨‹åº¦ä¸æ˜¯æŒ‰ç…§é¡ºåˆ©æ¥çš„ã€‚



## ä½ çŸ¥é“v-for ä¸­ keyä½œç”¨è·Ÿå·¥ä½œåŸç†å—ï¼Ÿ

æºç ä¸­æ‰¾ç­”æ¡ˆï¼šsrc\core\vdom\patch.js - updateChildren()





## è¯´ä¸€è¯´Vue ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°

1. **beforeCreateï¼š**åœ¨å®ä¾‹åˆå§‹åŒ–ä¹‹åï¼Œæ•°æ®è§‚æµ‹ï¼ˆdata observeï¼‰å’Œevent/watcheräº‹ä»¶é…ç½®ä¹‹å‰è¢«è°ƒ 

ç”¨ï¼Œè¿™æ—¶æ— æ³•è®¿é—®dataåŠpropsç­‰æ•°æ®ï¼›



2. **createdï¼š**åœ¨å®ä¾‹åˆ›å»ºå®Œæˆåè¢«ç«‹å³è°ƒç”¨ï¼Œæ­¤æ—¶å®ä¾‹å·²å®Œæˆæ•°æ®è§‚æµ‹ï¼ˆdata observerï¼‰ï¼Œå±æ€§å’Œæ–¹æ³• 

çš„è¿ç®—ï¼Œwatch/eventäº‹ä»¶å›è°ƒï¼ŒæŒ‚è½½é˜¶æ®µè¿˜æ²¡å¼€å§‹ï¼Œ $el å°šä¸å¯ç”¨ã€‚



3. **beforemount:**åœ¨æŒ‚è½½å¼€å§‹ä¹‹å‰è¢«è°ƒç”¨ï¼Œç›¸å…³çš„renderå‡½æ•°é¦–æ¬¡è¢«è°ƒç”¨



4. **mountedï¼š**å®ä¾‹è¢«æŒ‚è½½åè°ƒç”¨ï¼Œè¿™æ—¶elè¢«æ–°åˆ›å»ºçš„vm. $el æ›¿æ¢ï¼Œè‹¥æ ¹å®ä¾‹æŒ‚è½½åˆ°äº†æ–‡æ¡£ä¸Šçš„å…ƒç´  

ä¸Šï¼Œå½“mountedè¢«è°ƒç”¨æ—¶vm.$elä¹Ÿåœ¨æ–‡æ¡£å†…ã€‚æ³¨æ„mountedä¸ä¼šä¿è¯æ‰€æœ‰å­ç»„ä»¶ä¸€èµ·æŒ‚è½½ã€‚ 



5. **beforeupdatedï¼š**æ•°æ®æ›´æ–°æ—¶è°ƒç”¨ï¼Œå‘ç”Ÿåœ¨è™šæ‹Ÿdomæ‰“è¡¥ä¸å‰ï¼Œè¿™æ—¶é€‚åˆåœ¨æ›´æ–°å‰è®¿é—®ç°æœ‰domï¼Œå¦‚ 

æ‰‹åŠ¨ç§»é™¤å·²æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨ã€‚ 



6. **updatedï¼š**åœ¨æ•°æ®å˜æ›´å¯¼è‡´çš„è™šæ‹Ÿdomé‡æ–°æ¸²æŸ“å’Œæ‰“è¡¥ä¸åï¼Œè°ƒç”¨è¯¥é’©å­ã€‚å½“è¿™ä¸ªé’©å­è¢«è°ƒç”¨æ—¶ï¼Œç»„ 

ä»¶domå·²æ›´æ–°ï¼Œå¯æ‰§è¡Œä¾èµ–äºdomçš„æ“ä½œã€‚å¤šæ•°æƒ…å†µä¸‹åº”åœ¨æ­¤æœŸé—´æ›´æ”¹çŠ¶æ€ã€‚ å¦‚éœ€æ”¹å˜ï¼Œæœ€å¥½ä½¿ç”¨watcheræˆ–è®¡ç®—å±æ€§å–ä»£ã€‚æ³¨æ„updatedä¸ä¼šä¿è¯æ‰€æœ‰çš„å­ç»„ä»¶éƒ½èƒ½ä¸€èµ·è¢«é‡ç»˜ã€‚ 



7. **beforedestoryï¼š**åœ¨å®ä¾‹é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚åœ¨è¿™æ—¶ï¼Œå®ä¾‹ä»å¯ç”¨ã€‚ 

   

8. **destroyedï¼š**å®ä¾‹é”€æ¯åè°ƒç”¨ï¼Œè¿™æ—¶vueå®ä¾‹çš„æ‰€æœ‰æŒ‡ä»¤éƒ½è¢«è§£ç»‘ï¼Œæ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨è¢«ç§»é™¤ï¼Œæ‰€æœ‰å­å® 

ä¾‹ä¹Ÿè¢«é”€æ¯



## Vue æ•°æ®å“åº”å¼æ€ä¹ˆåšåˆ°çš„ï¼Ÿ



## Vue.set æ˜¯åšä»€ä¹ˆç”¨çš„ï¼Ÿ







## Vue å¦‚ä½•å®ç°ç»„ä»¶é—´é€šä¿¡ï¼Ÿ

1. props â˜…â˜… ï¼ˆçˆ¶ä¼ å­ï¼‰
2.  $emit/$on â˜…â˜… äº‹ä»¶æ€»çº¿ ï¼ˆè·¨å±‚çº§é€šä¿¡ï¼‰
3.  vuex â˜…â˜…â˜…ï¼ˆçŠ¶æ€ç®¡ç† å¸¸ç”¨ çš†å¯ï¼‰
4.  provide/inject â˜…â˜…â˜… ï¼ˆé«˜é˜¶ç”¨æ³• = æ¨èä½¿ç”¨ ï¼‰ ä¼˜ç‚¹ï¼šä½¿ç”¨ç®€å• ç¼ºç‚¹ï¼šä¸æ˜¯å“åº”å¼



å¸¸è§ä½¿ç”¨åœºæ™¯å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š

- çˆ¶å­ç»„ä»¶é€šä¿¡ 

- å…„å¼Ÿç»„ä»¶é€šä¿¡ 

- è·¨å±‚ç»„ä»¶é€šä¿¡



### props

çˆ¶ç»„ä»¶Aé€šè¿‡ props å‘å­ç»„ä»¶Bä¼ é€’å€¼ï¼Œ Bç»„ä»¶é€šè¿‡ $emit å‘Aç»„ä»¶æ´¾å‘ä¸€ä¸ªäº‹ä»¶ï¼ŒAç»„ä»¶é€šè¿‡ v-on/@ è§¦å‘



### $emit/$on äº‹ä»¶æ€»çº¿ 

> vue å®ä¾‹ ä½œä¸ºäº‹ä»¶æ€»çº¿ï¼ˆäº‹ä»¶ä¸­å¿ƒï¼‰ç”¨æ¥è§¦å‘äº‹ä»¶å’Œç›‘å¬äº‹ä»¶ï¼Œå¯ä»¥é€šè¿‡æ­¤ç§æ–¹å¼è¿›è¡Œç»„ä»¶é—´é€šä¿¡åŒ…æ‹¬ï¼šçˆ¶å­ç»„ä»¶ã€å…„å¼Ÿç»„ä»¶ã€è·¨çº§ç»„ä»¶ 

ä¾‹å­ğŸ‘‡

åˆ›å»ºBusæ–‡ä»¶

```
// Bus.js åˆ›å»ºbusæ–‡ä»¶ 
import Vue from 'vue'
export defult new Vue()
```

çœ‹çœ‹ç»„ä»¶é—´æ€ä¹ˆä½¿ç”¨å§

```
	// ggç»„ä»¶
    <template id="a">
        <div>
            <h3>ggç»„ä»¶</h3> <button @click="sendMsg">å°†æ•°æ®å‘é€ç»™ddç»„ä»¶</button>
        </div>
    </template>
    <script>
        import bus from './bus'
        export default {
            methods: {
                sendMsg() {
                    bus.$emit('sendTitle', 'ä¼ é€’çš„å€¼')
                    å¼€è¯¾å§webå…¨æ ˆæ¶æ„å¸ˆ
                }
            }
        }
    </script>
```

ç„¶åçœ‹çœ‹ddç»„ä»¶ä½¿ç”¨ğŸ‘‡



```
	// ddç»„ä»¶
	<template>
        <div>æ¥æ”¶ggä¼ é€’è¿‡æ¥çš„å€¼ï¼š{{msg}} </div>
    </template>
    <script>
        import bus from './bus'
        export default {
            data() {
                return {
                    mag: ''
                }
            }
            mounted() {
                bus.$on('sendTitle', (val) => {
                    this.mag = val
                })
            }
        }
    </script>
```



### provide/inject

ä¸»è¦è§£å†³äº†è·¨çº§ç»„ä»¶é—´çš„é€šä¿¡é—®é¢˜ï¼Œä¸è¿‡å®ƒçš„ä½¿ç”¨åœºæ™¯ï¼Œä¸»è¦æ˜¯å­ç»„ä»¶è·å–ä¸Šçº§ç»„ä»¶çš„çŠ¶æ€ï¼Œè·¨çº§ç»„ä»¶é—´å»ºç«‹äº†ä¸€ç§ä¸»åŠ¨æä¾›ä¸ä¾èµ–æ³¨å…¥çš„å…³ç³»ã€‚ 

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼šprovide å’Œinjectç»‘å®šå¹¶ä¸æ˜¯å¯å“åº”çš„ã€‚è¿™æ˜¯åˆ»æ„ä¸ºä¹‹çš„ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä¼ å…¥äº†ä¸€ ä¸ªå¯ç›‘å¬çš„å¯¹è±¡ï¼Œé‚£ä¹ˆå…¶å¯¹è±¡çš„å±æ€§è¿˜æ˜¯å¯å“åº”çš„----vueå®˜æ–¹æ–‡æ¡£,æ‰€ä»¥ï¼Œä¸Šé¢ A.vue çš„ name å¦‚ æœæ”¹å˜äº†ï¼ŒB.vue çš„ this.name æ˜¯ä¸ä¼šæ”¹å˜çš„ã€‚



è§£å†³åŠæ³•ï¼š

**ä½¿ç”¨2.6æœ€æ–°API Vue.observable ä¼˜åŒ–å“åº”å¼ provide(æ¨è)**



## watch å’Œ computed åŒºåˆ«

### ä¾¦å¬å±æ€§watch

- æ›´å¤šçš„æ˜¯ã€Œè§‚å¯Ÿã€çš„ä½œç”¨ï¼Œç±»ä¼¼äºæŸäº›æ•°æ®çš„ç›‘å¬å›è°ƒ ï¼Œæ¯å½“ç›‘å¬çš„æ•°æ®å˜åŒ–æ—¶éƒ½ä¼šæ‰§è¡Œå›è°ƒè¿›è¡Œåç»­æ“ä½œï¼›
- ç›‘å¬çš„å‡½æ•°æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æœ€æ–°çš„å€¼ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯è¾“å…¥ä¹‹å‰çš„å€¼ï¼›
- å½“ä¸€ä¸ªå±æ€§å‘ç”Ÿå˜åŒ–æ—¶ï¼Œéœ€è¦æ‰§è¡Œå¯¹åº”çš„æ“ä½œï¼Œå¯ä»¥ä¸€å¯¹å¤šï¼›
- ç›‘å¬æ•°æ®å¿…é¡»æ˜¯dataä¸­å£°æ˜è¿‡æˆ–è€…çˆ¶ç»„ä»¶ä¼ é€’è¿‡æ¥çš„propsä¸­çš„æ•°æ®ï¼Œå½“æ•°æ®å˜åŒ–æ—¶ï¼Œè§¦å‘å…¶ä»–æ“ä½œï¼Œå‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼š



### è®¡ç®—å±æ€§computed

- æ˜¯è®¡ç®—å±æ€§ï¼Œä¾èµ–å…¶å®ƒå±æ€§å€¼ï¼Œå¹¶ä¸” computed çš„å€¼æœ‰ç¼“å­˜ï¼Œåªæœ‰å®ƒä¾èµ–çš„å±æ€§å€¼å‘ç”Ÿæ”¹å˜ï¼Œä¸‹ä¸€æ¬¡è·å– computed çš„å€¼æ—¶æ‰ä¼šé‡æ–°è®¡ç®— computed çš„å€¼ï¼›
- ä¸æ”¯æŒå¼‚æ­¥ï¼Œå½“computedå†…æœ‰å¼‚æ­¥æ“ä½œæ—¶æ— æ•ˆï¼Œæ— æ³•ç›‘å¬æ•°æ®çš„å˜åŒ–



### è¿ç”¨åœºæ™¯

- å½“æˆ‘ä»¬éœ€è¦è¿›è¡Œæ•°å€¼è®¡ç®—ï¼Œå¹¶ä¸”ä¾èµ–äºå…¶å®ƒæ•°æ®æ—¶ï¼Œåº”è¯¥ä½¿ç”¨ computedï¼Œå› ä¸ºå¯ä»¥åˆ©ç”¨ computed çš„ç¼“å­˜ç‰¹æ€§ï¼Œé¿å…æ¯æ¬¡è·å–å€¼æ—¶ï¼Œéƒ½è¦é‡æ–°è®¡ç®—ï¼›
- å½“æˆ‘ä»¬éœ€è¦åœ¨æ•°æ®å˜åŒ–æ—¶æ‰§è¡Œå¼‚æ­¥æˆ–å¼€é”€è¾ƒå¤§çš„æ“ä½œæ—¶ï¼Œåº”è¯¥ä½¿ç”¨ watchï¼Œä½¿ç”¨ watch é€‰é¡¹å…è®¸æˆ‘ä»¬æ‰§è¡Œå¼‚æ­¥æ“ä½œ ( è®¿é—®ä¸€ä¸ª API )ï¼Œé™åˆ¶æˆ‘ä»¬æ‰§è¡Œè¯¥æ“ä½œçš„é¢‘ç‡ï¼Œå¹¶åœ¨æˆ‘ä»¬å¾—åˆ°æœ€ç»ˆç»“æœå‰ï¼Œè®¾ç½®ä¸­é—´çŠ¶æ€ã€‚è¿™äº›éƒ½æ˜¯è®¡ç®—å±æ€§æ— æ³•åšåˆ°çš„ã€‚



## Vuex ä½ æ€ä¹ˆç”¨çš„ï¼Ÿ

Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚å®ç°äº†ä¸€ä¸ªå•å‘æ•°æ®æµï¼Œåœ¨å…¨å±€æ‹¥æœ‰ä¸€ä¸ªState å­˜æ”¾æ•°æ®ï¼Œå½“ç»„ä»¶è¦æ›´æ”¹State ä¸­çš„æ•°æ®æ—¶ï¼Œå¿…é¡»é€šè¿‡ Mutation æäº¤ä¿®æ”¹ä¿¡æ¯ï¼Œ** Mutation åŒæ—¶æä¾›äº†è®¢é˜…è€…æ¨¡å¼ä¾›å¤–éƒ¨æ’ä»¶è°ƒç”¨è·å– State æ•°æ®çš„æ›´æ–°ã€‚



ä¸»è¦åŒ…å«ä»¥ä¸‹å‡ ä¸ªæ¨¡å—ğŸ‘‡



### State

å®šä¹‰åº”ç”¨çŠ¶æ€çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥è®¾ç½®é»˜è®¤çš„åˆå§‹çŠ¶æ€ã€‚



### Getter

å¯ä»¥å°† getter ç†è§£ä¸ºè®¡ç®—å±æ€§ï¼Œ getter çš„è¿”å›å€¼æ ¹æ®ä»–çš„ä¾èµ–ç¼“å­˜èµ·æ¥ï¼Œä¾èµ–å‘ ç”Ÿå˜åŒ–æ‰ä¼šè¢«é‡æ–°è®¡ç®—ã€‚

```js
const store = new Vuex.Store({
  state: {
    todos: [
      { id: 1, text: '...', done: true },
      { id: 2, text: '...', done: false }
    ]
  },
  getters: {
    doneTodos: state => {
      return state.todos.filter(todo => todo.done)
    }
  }
})
store.getters.doneTodos // -> [{ id: 1, text: '...', done: true }]
```



ä½¿ç”¨mapGettersè¾…åŠ©å‡½æ•°, åˆ©ç”¨å¯¹è±¡å±•å¼€è¿ç®—ç¬¦å°†getteræ··å…¥computed å¯¹è±¡ä¸­



```
import {mapGetters} from 'vuex'
export default{
    computed:{
        ...mapGetters(['total','discountTotal'])
    }
}
```





### mutation

æ›´æ”¹ state ä¸­å”¯ä¸€çš„æ–¹æ³•æ˜¯æäº¤ `mutation `ã€‚è¯¥æ–¹æ³•éƒ½æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚ å›è°ƒå‡½æ•°å°±æ˜¯ä½¿åŠ²è¿›è¡ŒçŠ¶æ€ä¿®æ”¹çš„åœ°æ–¹ï¼Œå¹¶ä¸”ä¼šæ¥æ”¶ state ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•° `FunC` ä¸ºç¬¬äºŒ ä¸ªå‚æ•°ï¼Œ `FunC` ä¸ºè‡ªå®šä¹‰å‡½æ•°ï¼Œ mutation å¿…é¡»æ˜¯åŒæ­¥å‡½æ•°ã€‚ 

```js
// è¾…åŠ©å¯¹è±¡ mapMutations 
        mutations: {
            reducePrice: (state, FunC) => {
                return state.productList.forEach((product) => {
                    product.price -= FunC;
                })
            }
        }
```

é¡µé¢æ€ä¹ˆå»ä½¿ç”¨å‘¢ğŸ‘‡

```js
			<!--é¡µé¢ä½¿ç”¨-- >
            methods: {
                reducePrice() {
                    this.$store.commit('reducePrice', 4)
                }
            }
```

**ç»„ä»¶ä¸­é‡å¤ä½¿ç”¨mutation**

```
import { mapMutations } from 'vuex'
methods:{
    ...mapMutations({
        setPrice:'reducePrice',
    })
}
```

è°ƒç”¨this.setPrice(10)ç›¸å½“è°ƒç”¨this.$store.commit('reducePrice',10)



### action 

 action ç±»ä¼¼ mutation éƒ½æ˜¯ä¿®æ”¹çŠ¶æ€ï¼Œä¸åŒä¹‹å¤„

- action æäº¤çš„ mutation ä¸æ˜¯ç›´æ¥ä¿®æ”¹çŠ¶æ€ 

- action å¯ä»¥åŒ…å«å¼‚æ­¥æ“ä½œï¼Œè€Œ mutation ä¸è¡Œ 

- action ä¸­çš„å›è°ƒå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ context ï¼Œæ˜¯ä¸€ä¸ªä¸ store å®ä¾‹å…·æœ‰ç›¸åŒå±æ€§çš„ æ–¹æ³•çš„å¯¹è±¡ 

- action é€šè¿‡ store.dispatch è§¦å‘ï¼Œ mutation é€šè¿‡ store.commit æäº¤ 



```js
actions: {
            // æäº¤çš„æ˜¯mutationï¼Œå¯ä»¥åŒ…å«å¼‚æ­¥æ“ä½œ 
            reducePriceAsync: (context, payload) => {
                setTimeout(() => {
                    context.commit('reducePrice', payload);
                    // reducePriceä¸ºä¸Š ä¸€æ­¥mutationä¸­çš„å±æ€§ 
                }, 2000)
            }
        }
```

é¡µé¢ä¸­æ€ä¹ˆå»ä½¿ç”¨å‘¢

```
			<!--é¡µé¢ä½¿ç”¨-- >
            // è¾…åŠ©å¯¹è±¡ 
            mapActions methods: {
                reducePriceAsync() {
                    this.$store.dispatch('reducePriceAsync', 2)
                }
            }
```



### module

ç”±äºä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œåº”ç”¨çš„æ‰€æœ‰çŠ¶æ€ä¼šé›†ä¸­åˆ°ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¯¹è±¡ã€‚å½“åº”ç”¨å˜å¾—éå¸¸å¤æ‚æ—¶ï¼Œstore å¯¹è±¡å°±æœ‰å¯èƒ½å˜å¾—ç›¸å½“è‡ƒè‚¿ã€‚ä¸ºäº†è§£å†³ä»¥ä¸Šé—®é¢˜ï¼ŒVuex å…è®¸æˆ‘ä»¬å°† store åˆ†å‰²æˆæ¨¡å—ï¼ˆmoduleï¼‰

ä½¿ç”¨å¦‚ä¸‹

```
const moduleA = {
  state: () => ({ ... }),
  mutations: { ... },
  actions: { ... },
  getters: { ... }
}

const moduleB = {
  state: () => ({ ... }),
  mutations: { ... },
  actions: { ... }
}

const store = new Vuex.Store({
  modules: {
    a: moduleA,
    b: moduleB
  }
})
// å¦‚ä½•ä½¿ç”¨å‘¢
store.state.a // -> moduleA çš„çŠ¶æ€
store.state.b // -> moduleB çš„çŠ¶æ€
```



## VueRouter ä½ æ€ä¹ˆç”¨çš„ï¼Ÿ





## è·¯ç”±å®ˆå«æ˜¯ä»€ä¹ˆï¼Ÿ





## ç»„ä»¶ä¸­ data ä¸ºä»€ä¹ˆæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Ÿ



ç­”ğŸ‘‡

> Vueç»„ä»¶å¯èƒ½å­˜åœ¨å¤šä¸ªå®ä¾‹ï¼Œå¦‚æœä½¿ç”¨å¯¹è±¡å½¢å¼å®šä¹‰dataï¼Œåˆ™ä¼šå¯¼è‡´å®ƒä»¬å…±ç”¨ä¸€ä¸ªdataå¯¹è±¡ï¼Œé‚£ä¹ˆçŠ¶æ€å˜æ›´å°†ä¼šå½±å“æ‰€æœ‰ç»„ä»¶å®ä¾‹ï¼Œè¿™æ˜¯ä¸åˆç†çš„ï¼›é‡‡ç”¨å‡½æ•°å½¢å¼å®šä¹‰ï¼Œåœ¨initDataæ—¶ä¼šå°†å…¶ä½œä¸ºå·¥å‚å‡½æ•°è¿”å›å…¨æ–°dataå¯¹è±¡ï¼Œæœ‰æ•ˆè§„é¿å¤šå®ä¾‹ä¹‹é—´çŠ¶æ€æ±¡æŸ“é—®é¢˜ã€‚è€Œåœ¨Vueæ ¹å®ä¾‹åˆ›å»ºè¿‡ç¨‹ä¸­åˆ™ä¸å­˜åœ¨è¯¥é™åˆ¶ï¼Œä¹Ÿ æ˜¯å› ä¸ºæ ¹å®ä¾‹åªèƒ½æœ‰ä¸€ä¸ªï¼Œä¸éœ€è¦æ‹…å¿ƒè¿™ç§æƒ…å†µã€‚





## VueåŸç†é¢è¯•é¢˜



## è¯´ä¸€è¯´MVVM

ä¼ ç»Ÿç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯web1.0ï¼Œç”šè‡³æ˜¯web2.0é˜¶æ®µï¼Œé¡µé¢çš„æ¸²æŸ“æ˜¯é™æ€çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ›´æ–°éœ€è¦ä¾èµ–äºæ“ä½œDom,è€ŒMVVMçš„æå‡ºï¼Œè§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚

å…³é”®ç‚¹ï¼Œ**æ•°æ®é©±åŠ¨è§†å›¾**ï¼Œæˆ‘ä»¬æ— éœ€å»æ“ä½œDOMï¼Œåªéœ€è¦å…³å¿ƒæ•°æ®ï¼Œè§†å›¾ä¼šå¼‚æ­¥çš„å»æ›´æ–°ã€‚

MVVMå¯ä»¥æ‹†åˆ†æˆä¸‰éƒ¨åˆ†ï¼ŒModelï¼ŒViewï¼ŒViewModelã€‚

Modelå±‚:æˆ‘ç«‹å³çš„æ˜¯dataä¸­çš„æ•°æ®ï¼Œæˆ–è€…æ˜¯Vuexä¸­çš„çŠ¶æ€ã€‚

Viewå±‚:è§†å›¾ï¼Œæˆ‘æ›´å¤šçš„æ˜¯ç†è§£æˆDom

ViewModelå±‚ï¼šæŒ‰ç…§é€šä¿—çš„è¯ç†è§£ï¼Œæ›´åƒæ˜¯Vueæä¾›çš„ä¸€ç§èƒ½åŠ›ï¼Œå»ºç«‹èµ·ä¸¤è€…ä¹‹é—´çš„è¿æ¥ï¼Œæˆ‘æŠŠå®ƒçœ‹æˆæ˜¯è¿æ¥å±‚ã€‚



æ€ä¹ˆæ¥ç†è§£å‘¢ï¼Ÿæˆ‘æ˜¯è¿™ä¹ˆæƒ³çš„ğŸ‘‡

- å½“æ•°æ®Modelå±‚æ•°æ®å‘ç”Ÿæ”¹å˜çš„è¯ï¼ŒViewè§†å›¾å±‚å°±ä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ï¼Œæˆ‘ä»¬æ˜¯ä¸éœ€è¦å»æ“ä½œDomçš„ï¼Œè¿™ä¸ªå·¥ä½œå°±æ˜¯äº¤ç»™äº†ViewModelå±‚ï¼Œå®ƒæ¥å¸®æˆ‘ä»¬å®Œæˆã€‚
- Viewå±‚ï¼Œæ¯”å¦‚ä½ æœ‰ç‚¹å‡»äº‹ä»¶ï¼Œè¿™äº›éƒ½æ˜¯å¯ä»¥ä¿®æ”¹Modelå±‚ä¸­çš„æ•°æ®çš„ï¼Œæ‰€ä»¥è¯´ï¼ŒViewModelå±‚æ›´åƒæ˜¯ä¸€ä¸ªæ¡¥æ¢ï¼Œæä¾›äº†ä¸€ç§èƒ½åŠ›ï¼Œè®©æˆ‘ä»¬ä¸åœ¨å»å…³å¿ƒå¦‚ä½•å»æ“ä½œDomã€‚





## Vueå“åº”å¼åŸç†

ä»€ä¹ˆæ˜¯å“åº”å¼ï¼Œæˆ‘çš„ç†è§£å°±æ˜¯ç»„ä»¶ä¸­çš„dataæ•°æ®ä¸€æ—¦å‘ç”Ÿå˜åŒ–ï¼Œä¼šè§¦å‘è§†å›¾çš„æ›´æ–°ã€‚é‚£ä¹ˆæ˜¯å¦‚ä½•ç›‘å¬æ•°æ®å‘ç”Ÿæ”¹å˜ï¼Œç„¶åå»é€šçŸ¥è§†å›¾Viewå±‚æ”¹å˜çš„å‘¢ï¼ŸğŸ‘‰**Object.defineProperty()**

æ ¸å¿ƒAPIå°±æ˜¯**Object.defineProperty()**ï¼Œé‚£ä¹ˆå®ƒçš„ç”¨æ³•æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

- å¯ä»¥æ£€æµ‹å¯¹è±¡ä¸­æ•°æ®å‘ç”Ÿçš„ä¿®æ”¹
- å¯¹äºå¤æ‚çš„å¯¹è±¡ï¼Œå±‚çº§å¾ˆæ·±çš„è¯ï¼Œæ˜¯ä¸å‹å¥½çš„ï¼Œéœ€è¦ç»è¡Œæ·±åº¦ç›‘å¬ï¼Œè¿™æ ·å­å°±éœ€è¦é€’å½’åˆ°åº•ï¼Œè¿™ä¹Ÿæ˜¯å®ƒçš„ç¼ºç‚¹ã€‚
- å¯¹äºä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå¦‚æœä½ æ–°å¢åŠ å±æ€§ï¼Œåˆ é™¤å±æ€§ï¼Œ**Object.defineProperty()**æ˜¯ä¸èƒ½è§‚æµ‹åˆ°çš„ï¼Œé‚£ä¹ˆåº”è¯¥å¦‚ä½•è§£å†³å‘¢ï¼Ÿå¯ä»¥é€šè¿‡Vue.set()å’ŒVue.delete()æ¥å®ç°ã€‚

åŸºäºä»¥ä¸Šçš„ç‚¹ï¼ŒVue3.0ç‰ˆæœ¬ä¹Ÿå°±æ˜¯æå‡ºäº†Proxyï¼Œå½“ç„¶äº†Proxyå¯¹æµè§ˆå™¨å…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯”å¦‚IE11ç‰ˆæœ¬ä¸å…¼å®¹ï¼Œä¹Ÿæ— æ³•polyfillï¼Œå—¯â€¦.ï¼Œå…ˆçœ‹ä¸‹**Object.defineProperty()**æ˜¯å¦‚ä½•ä½¿ç”¨çš„å§ã€‚

å†™ä¸ªç®€å•çš„æ¨¡æ‹Ÿæ‹¦æˆªæ•°æ®å§ğŸ‘‡

```
// æ¨¡æ‹Ÿæ›´æ–°è§†å›¾æ“ä½œ
function update(){
    console.log('æ•°æ®å‘ç”Ÿæ”¹å˜')
}

// ä»æ–°å»å®šä¹‰ç›‘å¬å±æ€§
function defineVue(target, key, value) {

    // æ ¸å¿ƒAPI
    Object.defineProperty(target, key, {
        get() {
            return value
        },
        set(newValue) {
            if(newValue !== value){

                // valueæ˜¯å­˜åœ¨é—­åŒ…ä¸­çš„,é€šè¿‡getè·å–çš„ä¹Ÿæ˜¯æœ€æ–°çš„value
                value = newValue

                // è§¦å‘è§†å›¾
                update()
            }
        },
    })
}


function observer(target) {
    // åˆ¤æ–­æ˜¯ä¸æ˜¯å¯¹è±¡
    if(typeof target !== 'object' || target === null ) return target

    for(let key in target) {
        defineVue(target,key,target[key])
    }
}


// ç›‘å¬æ•°æ®
let data = {
    name : "TianTian",
    age : 18,
    list : [1,2,3],
    major : {
        Math : 140
    }
}

// ç›‘å¬æ•°æ®
observer(data)

// æµ‹è¯•æ•°æ®
data.name = 'newName'   // è¿™ä¸ªè§¦å‘äº†update
data.major.Math = 150    // è¿™ä¸ªå°±ä¸ä¼šå»è§¦å‘è§†å›¾æ›´æ–° update
```

è¿™æ ·å­æ¥çœ‹ï¼Œç¬¬53è¡Œæ˜¯ä¸ä¼šå»è§¦å‘ï¼Œä¹Ÿå°±æ˜¯è¯´å¯¹äº**å¼•ç”¨ç±»å‹ï¼Œæ˜¯ç›‘å¬ä¸åˆ°çš„**ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å»è¿›è¡Œæ·±åº¦ç›‘å¬ï¼Œ

åŠ ä¸Šå‡ è¡Œä»£ç å°±è¡Œ

```js
// æ¨¡æ‹Ÿæ›´æ–°è§†å›¾æ“ä½œ
function update(){
    console.log('æ•°æ®å‘ç”Ÿæ”¹å˜')
}

// ä»æ–°å»å®šä¹‰ç›‘å¬å±æ€§
function defineVue(target, key, value) {

    observer(value)  // æ·±åº¦ç›‘å¬

    // æ ¸å¿ƒAPI
    Object.defineProperty(target, key, {
        get() {
            return value
        },
        set(newValue) {
            if(newValue !== value){

                observer(newValue)  // è®¾ç½®æ–°çš„å€¼ä¹Ÿæ˜¯éœ€è¦å»ç›‘å¬çš„ æ¯”å¦‚data.age = {son : 123}  è¿™æ ·å­çš„è¯,ä¹Ÿå¯ä»¥é¿å…é—®é¢˜

                // valueæ˜¯å­˜åœ¨é—­åŒ…ä¸­çš„,é€šè¿‡getè·å–çš„ä¹Ÿæ˜¯æœ€æ–°çš„value
                value = newValue

                // è§¦å‘è§†å›¾
                update()
            }
        },
    })
}


function observer(target) {

    // åˆ¤æ–­æ˜¯ä¸æ˜¯å¯¹è±¡
    if(typeof target !== 'object' || target === null ) return target

    for(let key in target) {
        defineVue(target,key,target[key])
    }
}


// ç›‘å¬æ•°æ®
let data = {
    name : "TianTian",
    age : 18,
    list : [1,2,3],
    major : {
        Math : 140   // éœ€è¦æ·±åº¦ç›‘å¬
    }
}

// ç›‘å¬æ•°æ®
observer(data)

// æµ‹è¯•æ•°æ®
data.name = 'newName'   // è¿™ä¸ªè§¦å‘äº†update
console.log(data.age)
data.major.Math = 150    // è¿™ä¸ªå°±ä¸ä¼šå»è§¦å‘è§†å›¾æ›´æ–° update
console.log(data.major.Math = 150)
data.age = { so : 'ä¿®æ”¹çš„æ•°æ®æ˜¯å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥ç›‘å¬åˆ°'}     // é€šè¿‡å¯¹newValueé‡æ–°å»ç›‘å¬

data['some']= 'æ–°å¢åŠ å±æ€§'   // ç›‘å¬æ­¥åˆ°ï¼Œæ‰€ä»¥éœ€è¦ Vue.set()
delete data.age            // åˆ é™¤çš„è¯,ä¹Ÿæ˜¯ä¸è¡Œï¼Œæ‰€ä»¥éœ€è¦Vue.delete()
```

ä»ä¸Šé¢ä»£ç æ¥çœ‹ï¼Œç¼ºç‚¹ä¹Ÿæ˜¯æœ‰çš„ğŸ‘‡

- å¯¹äºç›‘å¬å¯¹è±¡å¾ˆå¤æ‚ï¼Œéœ€è¦æ·±åº¦ç›‘å¬ï¼Œéœ€è¦é€’å½’åˆ°åº•ï¼Œä¸€æ¬¡æ€§è®¡ç®—å¤§
- æ— æ³•ç›‘å¬æ–°å¢å’Œåˆ é™¤å±æ€§(Vue.set() / Vue.delete())



**å¦‚ä½•ç›‘å¬æ•°ç»„å‘¢**

é€šè¿‡å°†æ•°ç»„çš„å¸¸ç”¨æ–¹æ³•è¿›è¡Œé‡å†™ï¼Œé€šè¿‡åŒ…è£…ä¹‹åçš„æ•°ç»„æ–¹æ³•å°±èƒ½å¤Ÿå»åœ¨è°ƒç”¨çš„æ—¶å€™è¢«ç›‘å¬åˆ°ã€‚

```js
const arrContext = Object.create(Array.prototype)
const arrMethods = [
    'push',
    'pop',
    'shift',
    'unshift',
    'splice',
    'sort',
    'reverse'
]
arrMethods.forEach(methodName => {
    arrContext[methodName] = function(...args){
        Array.prototype[methodName].apply(this,args)
        console.log(`${methodName}æ–¹æ³•è¢«æ‰§è¡Œäº†`)
    }
})

export default arrContext
```

ç„¶åå†åˆ¤æ–­å¦‚æœæ˜¯æ•°ç»„çš„è¯ï¼Œä¹Ÿå°±æ˜¯

```
if(Array.isArray(target)){
        target.__proto__ = arrContext
}
```

è¿™æ ·å­å°±å¯ä»¥æ£€æµ‹æ•°ç»„çš„å˜åŒ–äº†ã€‚