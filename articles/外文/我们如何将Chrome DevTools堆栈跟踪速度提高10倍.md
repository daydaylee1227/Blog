## 我们如何将Chrome DevTools堆栈跟踪速度提高10倍



Web开发人员期望在调试代码时几乎不会影响性能。但是，这种期望绝不是普遍的。 C ++开发人员永远不会期望其应用程序的调试版本能够达到生产性能，并且在Chrome的早期，仅仅打开DevTools会对页面的性能产生重大影响。





现在已经感觉不到这种性能下降了，这是多年来对DevTools和V8的调试能力投资的结果。尽管如此，我们永远无法将DevTools的性能开销降低到零。设置断点、踏过代码、收集堆栈痕迹、捕获性能跟踪等等，都会在不同程度上影响执行速度。毕竟，观察到的东西会改变它。



但当然，DevTools的开销--像任何调试器一样--应该是合理的。最近我们看到，在某些情况下，DevTools会拖慢应用程序的速度，以至于它不能再使用的报告数量显著增加。下面你可以看到一个来自报告chromium:1069425的并排比较，说明了仅仅打开DevTools的性能开销。



报告chromium:1069425链接点这里:

> https://bugs.chromium.org/p/chromium/issues/detail?id=1069425

可以查看这个视频:







正如你从**视频**中看到的，速度降低了**5-10**倍，这显然是不可接受的。

第一步是要了解所有的时间都去哪儿了，是什么导致了DevTools打开时的巨大速度下降。

在Chrome渲染器进程上使用Linux perf，发现整个渲染器执行时间的分布如下。

