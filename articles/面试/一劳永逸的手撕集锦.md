## å‰è¨€

åŸºæœ¬ä¸Šé¢è¯•çš„æ—¶å€™ï¼Œç»å¸¸ä¼šé‡åˆ°æ‰‹æ’•XXXä¹‹ç±»çš„é—®é¢˜ï¼Œè¿™æ¬¡å‡†å¤‡æ¢³ç†æ€»ç»“ä¸€éï¼Œå·©å›ºæˆ‘ä»¬åŸç”ŸJSåŸºç¡€çš„åŒæ—¶ï¼Œä¸‹æ¬¡æƒ³å¤ä¹ é¢è¯•æ‰‹æ’•é¢˜çš„æ—¶å€™ï¼Œæ‰¾èµ·æ¥æ–¹ä¾¿ï¼Œä¹ŸèŠ‚çœæ—¶é—´ã€‚









## DOM

### å®ç°ä¸€ä¸ªäº‹ä»¶å§”æ‰˜ï¼ˆæ˜“é”™ï¼‰

äº‹ä»¶å§”æ‰˜è¿™é‡Œå°±ä¸é˜è¿°äº†ï¼Œæ¯”å¦‚ç»™liç»‘å®šç‚¹å‡»äº‹ä»¶

çœ‹é”™è¯¯ç‰ˆï¼Œ(å®¹æ˜“è¿‡çš„ï¼Œçœ‹**é¢è¯•å®˜æ°´å¹³äº†**)ğŸ‘‡

```js

ul.addEventListener('click', function (e) {
            console.log(e,e.target)
            if (e.target.tagName.toLowerCase() === 'li') {
                console.log('æ‰“å°')  // æ¨¡æ‹Ÿfn
            }
})
```

**æœ‰ä¸ªå°bugï¼Œå¦‚æœç”¨æˆ·ç‚¹å‡»çš„æ˜¯ li é‡Œé¢çš„ spanï¼Œå°±æ²¡æ³•è§¦å‘ fnï¼Œè¿™æ˜¾ç„¶ä¸å¯¹**ğŸ‘‡

```
<ul id="xxx">ä¸‹é¢çš„å†…å®¹æ˜¯å­å…ƒç´ 1
        <li>liå†…å®¹>>> <span> è¿™æ˜¯spanå†…å®¹123</span></li>
        ä¸‹é¢çš„å†…å®¹æ˜¯å­å…ƒç´ 2
        <li>liå†…å®¹>>> <span> è¿™æ˜¯spanå†…å®¹123</span></li>
        ä¸‹é¢çš„å†…å®¹æ˜¯å­å…ƒç´ 3
        <li>liå†…å®¹>>> <span> è¿™æ˜¯spanå†…å®¹123</span></li>
</ul>
```

è¿™æ ·å­çš„åœºæ™¯å°±æ˜¯ä¸å¯¹çš„ï¼Œé‚£æˆ‘ä»¬çœ‹çœ‹é«˜çº§ç‰ˆæœ¬ğŸ‘‡

```js
		function delegate(element, eventType, selector, fn) {
            element.addEventListener(eventType, e => {
                let el = e.target
                while (!el.matches(selector)) {
                    if (element === el) {
                        el = null
                        break
                    }
                    el = el.parentNode
                }
                el && fn.call(el, e, el)
            },true)
            return element
        }
```



### å®ç°ä¸€ä¸ªå¯ä»¥æ‹–æ‹½çš„DIV

è¿™ä¸ªé¢˜ç›®çœ‹èµ·æ¥ç®€å•ï¼Œä½ å¯ä»¥è¯•ä¸€è¯•30åˆ†é’Ÿèƒ½ä¸èƒ½å®Œæˆï¼Œç›´æ¥è´´å‡ºä»£ç å§ğŸ‘‡

```
<div id="xxx"></div>
```

```js
var dragging = false
var position = null

xxx.addEventListener('mousedown',function(e){
  dragging = true
  position = [e.clientX, e.clientY]
})


document.addEventListener('mousemove', function(e){
  if(dragging === false) return null
  const x = e.clientX
  const y = e.clientY
  const deltaX = x - position[0]
  const deltaY = y - position[1]
  const left = parseInt(xxx.style.left || 0)
  const top = parseInt(xxx.style.top || 0)
  xxx.style.left = left + deltaX + 'px'
  xxx.style.top = top + deltaY + 'px'
  position = [x, y]
})
document.addEventListener('mouseup', function(e){
  dragging = false
})
```



## CSS





## JS

### æ‰‹å†™é˜²æŠ–å’ŒèŠ‚æµå‡½æ•°

**èŠ‚æµthrottle**ï¼Œè§„å®šåœ¨ä¸€ä¸ªå•ä½æ—¶é—´å†…ï¼Œåªèƒ½è§¦å‘ä¸€æ¬¡å‡½æ•°ã€‚å¦‚æœè¿™ä¸ªå•ä½æ—¶é—´å†…è§¦å‘å¤šæ¬¡å‡½æ•°ï¼Œåªæœ‰ä¸€æ¬¡ç”Ÿæ•ˆã€‚åœºæ™¯ğŸ‘‡

- scrollæ»šåŠ¨äº‹ä»¶ï¼Œæ¯éš”ç‰¹å®šæè¿°æ‰§è¡Œå›è°ƒå‡½æ•°
- inputè¾“å…¥æ¡†ï¼Œæ¯ä¸ªç‰¹å®šæ—¶é—´å‘é€è¯·æ±‚æˆ–æ˜¯å±•å¼€ä¸‹æ‹‰åˆ—è¡¨ï¼Œï¼ˆé˜²æŠ–ä¹Ÿå¯ä»¥ï¼‰

èŠ‚æµé‡åœ¨åŠ é”**flag = false**

```
function throttle(fn, delay) {
    let flag = true,
        timer = null
    return function(...args) {
        let context = this
        if(!flag) return
        
        flag = false
        clearTimeout(timer)
        timer = setTimeout(function() {
            fn.apply(context,args)
            flag = true
        },delay)
    }
}
```



**é˜²æŠ–debounce**,åœ¨äº‹ä»¶è¢«è§¦å‘nç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™nç§’å†…åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶ã€‚åœºæ™¯ğŸ‘‡

- æµè§ˆå™¨çª—å£å¤§å°resizeé¿å…æ¬¡æ•°è¿‡äºé¢‘ç¹
- ç™»å½•ï¼Œå‘çŸ­ä¿¡ç­‰æŒ‰é’®é¿å…å‘é€å¤šæ¬¡è¯·æ±‚
- æ–‡æœ¬ç¼–è¾‘å™¨å®æ—¶ä¿å­˜

é˜²æŠ–é‡åœ¨æ¸…é›¶**clearTimeout(timer)**

```
function debounce(fn, delay) {
    let timer = null
    return function(...args) {
        let context = this
        if(timer) clearTimeout(timer)
        timer = setTimeout(function(){
            fn.apply(context,args)
        },delay)
    }
}
```





### æ‰‹å†™AJAX



### æ·±æ‹·è´

æ·±æ‹·è´è§£å†³çš„å°±æ˜¯**å…±ç”¨å†…å­˜åœ°å€æ‰€å¯¼è‡´çš„æ•°æ®é”™ä¹±é—®é¢˜**

æ€è·¯ï¼š

- é€’å½’

- åˆ¤æ–­ç±»å‹

- æ£€æŸ¥ç¯ï¼ˆä¹Ÿå«å¾ªç¯å¼•ç”¨ï¼‰

- éœ€è¦å¿½ç•¥åŸå‹

```
function deepClone(obj, map = new WeakMap()) {
    if (obj instanceof RegExp) return new RegExp(obj);
    if (obj instanceof Date) return new Date(obj);

    if (obj == null || typeof obj != 'object') return obj;
    if (map.has(obj)) {
        return map.get(obj);
    }
    let t = new obj.constructor();
    map.set(obj, t);
    for (let key in obj) {
        if (obj.hasOwnProperty(key)) {
            t[key] = deepClone(obj[key], map);
        }
    }
    return t;
}
//æµ‹è¯•ç”¨ä¾‹
let obj = {
    a: 1,
    b: {
        c: 2,
        d: 3
    },
    d: new RegExp(/^\s+|\s$/g)
}

let clone_obj = deepClone(obj)
obj.d = /^\s|[0-9]+$/g
console.log(clone_obj)
console.log(obj)
```





### ç”¨æ­£åˆ™å®ç° trim()

å»æ‰é¦–ä½å¤šä½™çš„ç©ºæ ¼ğŸ‘‡

```
String.prototype.trim = function(){
    return this.replace(/^\s+|\s+$/g, '')
}
//æˆ–è€… 
function trim(string){
    return string.replace(/^\s+|\s+$/g, '')
}
```





### å®ç°æ•°ç»„å»é‡





### å®ç°Object.createæ–¹æ³•

```
//å®ç°Object.createæ–¹æ³•
function create(proto) {
    function Fn() {};
    Fn.prototype = proto;
    Fn.prototype.constructor = Fn;
    return new Fn();
}
let demo = {
    c : '123'
}
let cc = Object.create(demo)
```



### æ‰‹å†™callå’Œapply

```
// å®ç°call
Function.prototype.mycall = function () {
    let [thisArg, ...args] = [...arguments]
    thisArg = Object(thisArg) || window
    let fn = Symbol()
    thisArg[fn] = this
    let result = thisArg[fn](...args)
    delete thisArg[fn]
    return result
}
// å®ç°apply
Function.prototype.myapply = function () {
    let [thisArg, args] = [...arguments];
    thisArg = Object(thisArg)
    let fn = Symbol()
    thisArg[fn] = this;
    let result = thisArg[fn](...args);
    delete thisArg.fn;
    return result;
}

//æµ‹è¯•ç”¨ä¾‹
let cc = {
    a: 1
}

function demo(x1, x2) {
    console.log(typeof this, this.a, this)
    console.log(x1, x2)
}
demo.apply(cc, [2, 3])
demo.myapply(cc, [2, 3])
demo.call(cc,33,44)
demo.mycall(cc,33,44)

```



### æ‰‹å†™bind





### å®ç°newæ“ä½œ

æ ¸å¿ƒè¦ç‚¹ğŸ‘‡

1. åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„`__proto__`è¦æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡
2. æ‰§è¡Œæ„é€ å‡½æ•°
3. è¿”å›å€¼ä¸ºobjectç±»å‹åˆ™ä½œä¸ºnewæ–¹æ³•çš„è¿”å›å€¼è¿”å›ï¼Œå¦åˆ™è¿”å›ä¸Šè¿°å…¨æ–°å¯¹è±¡

ä»£ç å¦‚ä¸‹ğŸ‘‡

```
function _new() {
    let obj = {};
    let [constructor, ...args] = [...arguments];
    obj.__proto__ = constructor.prototype;
    let result = constructor.apply(obj, args);
    if (result && typeof result === 'function' || typeof result === 'object') {
        return result;
    }
    return obj;
}
```



### å®ç°ä¸€ä¸ªå¯¹è±¡ç±»å‹çš„å‡½æ•°

æ ¸å¿ƒï¼šObject.prototype.toString 

```
let isType = (type) => (obj) => Object.prototype.toString.call(obj) === `[object ${type}]`

// let isArray = isType('Array')
// let isFunction = isType('Function')
// console.log(isArray([1,2,3]),isFunction(Map))
```

isTypeå‡½æ•°ğŸ‘†ï¼Œä¹Ÿå±äº**åå‡½æ•°**çš„èŒƒç•´ï¼Œåå‡½æ•°å®é™…ä¸Šæ˜¯è¿”å›äº†ä¸€ä¸ªåŒ…å«**é¢„å¤„ç†å‚æ•°**çš„æ–°å‡½æ•°ã€‚



### å®ç°instanceof

**instanceof** **è¿ç®—ç¬¦**ç”¨äºæ£€æµ‹æ„é€ å‡½æ•°çš„ `prototype` å±æ€§æ˜¯å¦å‡ºç°åœ¨æŸä¸ªå®ä¾‹å¯¹è±¡çš„åŸå‹é“¾ä¸Šã€‚

è¯­æ³•ğŸ‘‡

```
object instanceof constructor
object æŸä¸ªå®ä¾‹å¯¹è±¡
construtor æŸä¸ªæ„é€ å‡½æ•°
```

åŸå‹é“¾çš„å‘ä¸Šæ‰¾ï¼Œæ‰¾åˆ°åŸå‹çš„æœ€é¡¶ç«¯ï¼Œä¹Ÿå°±æ˜¯Object.prototypeï¼Œä»£ç ğŸ‘‡

```
function my_instance_of(leftVaule, rightVaule) {
    if(typeof leftVaule !== 'object' || leftVaule === null) return false;
    let rightProto = rightVaule.prototype,
        leftProto = leftVaule.__proto__;
    while (true) {
        if (leftProto === null) {
            return false;
        }
        if (leftProto === rightProto) {
            return true;
        }
        leftProto = leftProto.__proto__
    }
}

```



### å®ç°æŸ¯é‡ŒåŒ–å‡½æ•°

æŸ¯é‡ŒåŒ–å°±æ˜¯æŠŠæ¥å—**å¤šä¸ªå‚æ•°**çš„å‡½æ•°å˜æ¢æˆæ¥å—ä¸€ä¸ª**å•ä¸€å‚æ•°**çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›æ¥å—**ä½™ä¸‹å‚æ•°**è¿”å›ç»“æœçš„ä¸€ç§åº”ç”¨ã€‚

æ€è·¯ï¼š

- åˆ¤æ–­ä¼ é€’çš„å‚æ•°æ˜¯å¦è¾¾åˆ°æ‰§è¡Œå‡½æ•°çš„fnä¸ªæ•°
- æ²¡æœ‰è¾¾åˆ°çš„è¯ï¼Œç»§ç»­è¿”å›æ–°çš„å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›curryå‡½æ•°ä¼ é€’å‰©ä½™å‚æ•°



```
let currying = (fn, ...args) =>
            fn.length > args.length ?
            (...arguments) => currying(fn, ...args, ...arguments) :
            fn(...args)
```

æµ‹è¯•ç”¨ä¾‹ğŸ‘‡

```
let addSum = (a, b, c) => a+b+c
let add = curry(addSum)
console.log(add(1)(2)(3))
console.log(add(1, 2)(3))
console.log(add(1,2,3))
```





### å®ç°æ•°ç»„flat



### å®ç°sleep



æŸä¸ªæ—¶é—´åå°±å»æ‰§è¡ŒæŸä¸ªå‡½æ•°ï¼Œä½¿ç”¨Promiseå°è£…ğŸ‘‡

```
function sleep(fn, time) {
    return new Promise((resolve, reject) => {
        setTimeout(() => {
            resolve(fn);
        }, time);
    });
}
let saySomething = (name) => console.log(`hello,${name}`)
async function autoPlay() {
    let demo = await sleep(saySomething('TianTian'),1000)
    let demo2 = await sleep(saySomething('æç£Š'),1000)
    let demo3 = await sleep(saySomething('æ˜é‡‘çš„å¥½å‹ä»¬'),1000)
}
autoPlay()
```



### å®ç°æ•°ç»„reduce

æ›´å¤šçš„æ‰‹å†™å®ç°æ•°ç»„æ–¹æ³•ï¼Œçœ‹æˆ‘ä¹‹å‰è¿™ç¯‡ğŸ‘‰ [ã€Œæ•°ç»„æ–¹æ³•ã€ä»è¯¦ç»†æ“ä½œjsæ•°ç»„åˆ°æµ…æv8ä¸­array.js](https://juejin.im/post/5f02e7725188252e8272cd47)

ç›´æ¥ç»™å‡ºç®€æ˜“ç‰ˆğŸ‘‡

```
Array.prototype.myreduce = function(fn, initVal) {
    let result = initVal,
        i = 0;
    if(typeof initVal  === 'undefined'){
        result = this[i]
        i++;
    }
    while( i < this.length ){
        result = fn(result, this[i])
    }
    return result
}
```



### ç”¨å‘å¸ƒè®¢é˜…æ¨¡å¼å®ç°EventEmit



### å®ç°Promise.allå’Œrace

ä¸æ¸…æ¥šä¸¤è€…ç”¨æ³•çš„è¯ï¼Œå¼‚æ­¥MDNğŸ‘‰[Promise.race()](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/race)  [Promise.all()](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise/all)

 

```js
// å®ç°Promise.all ä»¥åŠ race

Promise.myall = function (arr) {
    return new Promise((resolve, reject) => {
        if (arr.length === 0) {
            return resolve([])
        } else {
            let res = [],
                count = 0
            for (let i = 0; i < arr.length; i++) {
                // åŒæ—¶ä¹Ÿèƒ½å¤„ç†arræ•°ç»„ä¸­éPromiseå¯¹è±¡
                if (!(arr[i] instanceof Promise)) {
                    res[i] = arr[i]
                    if (++count === arr.length)
                        resolve(res)
                } else {
                    arr[i].then(data => {
                        res[i] = data
                        if (++count === arr.length)
                            resolve(res)
                    }, err => {
                        reject(err)
                    })
                }

            }
        }
    })
}

Promise.myrace = function (arr) {
    return new Promise((resolve, reject) => {
        for (let i = 0; i < arr.length; i++) {
            // åŒæ—¶ä¹Ÿèƒ½å¤„ç†arræ•°ç»„ä¸­éPromiseå¯¹è±¡
            if (!(arr[i] instanceof Promise)) {
                Promise.resolve(arr[i]).then(resolve, reject)
            } else {
                arr[i].then(resolve, reject)
            }

        }
    })
}

```

æµ‹è¯•ç”¨ä¾‹ğŸ‘‡

```
// æµ‹è¯•ç”¨ä¾‹
let p1 = new Promise((resolve, reject) => {
    setTimeout(() => {
        resolve(11)
    }, 2000);
});
let p2 = new Promise((resolve, reject) => {
    reject('asfs')

});
let p3 = new Promise((resolve) => {
    setTimeout(() => {
        resolve(33);
    }, 4);
});

Promise.myall([p3, p1, 3, 4]).then(data => {
    // æŒ‰ä¼ å…¥æ•°ç»„çš„é¡ºåºæ‰“å°
    console.log(data); // [3, 1, 2]
}, err => {
    console.log(err)
});

Promise.myrace([p1, p2, p3]).then(data => {
    // è°å¿«å°±æ˜¯è°
    console.log(data); // 2
}, err => {
    console.log('å¤±è´¥è·‘çš„æœ€å¿«')
})
```



### æ‰‹å†™ç»§æ‰¿