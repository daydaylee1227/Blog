## å‰è¨€

è¿™æ¬¡æ¢³ç†çš„ç¯‡å¹…ä¸»è¦æ˜¯æ¶‰åŠç½‘ç»œéƒ¨åˆ†ï¼ŒåŒ…æ‹¬HTTPï¼ŒTCPç­‰åè®®ï¼Œæœ‰äº†æ›´åŠ æ·±å…¥çš„äº†è§£ï¼Œå¯¹å·©å›ºè‡ªå·±çš„ç½‘ç»œçŸ¥è¯†ä½“ç³»ä¹Ÿæ˜¯å¾ˆæœ‰å¸®åŠ©çš„ï¼Œè¿›ä¸€æ­¥çš„å¯¹æ€§èƒ½ä¼˜åŒ–ä¸Šä¹Ÿæ˜¯å¸®åŠ©å¾ˆå¤§çš„ã€‚





> æ„Ÿè°¢æ˜å‹çš„é¼“åŠ±ä¸æ”¯æŒğŸŒ¹ğŸŒ¹ğŸŒ¹ï¼Œå¾€æœŸæ–‡ç« éƒ½åœ¨æœ€åæ¢³ç†å‡ºæ¥äº†(â—'â—¡'â—)



æ¥ä¸‹æ¥å°±ä»¥é—®é¢˜çš„å½¢å¼å±•å¼€æ¢³ç†ğŸ‘‡



## è°ˆä¸€è°ˆHTTPåè®®ä¼˜ç¼ºç‚¹

è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œ**HTTP æ˜¯ä¸€ä¸ªåœ¨è®¡ç®—æœºä¸–ç•Œé‡Œä¸“é—¨åœ¨ä¸¤ç‚¹ä¹‹é—´ä¼ è¾“æ–‡å­—ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰è¶…æ–‡æœ¬æ•°æ®çš„çº¦å®šå’Œè§„èŒƒ**ã€‚

### HTTP ç‰¹ç‚¹

1. **çµæ´»å¯æ‰©å±•**ã€‚ä¸€ä¸ªæ˜¯è¯­æ³•ä¸Šåªè§„å®šäº†åŸºæœ¬æ ¼å¼ï¼Œç©ºæ ¼åˆ†éš”å•è¯ï¼Œæ¢è¡Œåˆ†éš”å­—æ®µç­‰ã€‚å¦å¤–ä¸€ä¸ªå°±æ˜¯ä¼ è¾“å½¢å¼ä¸Šä¸ä»…å¯ä»¥ä¼ è¾“æ–‡æœ¬ï¼Œè¿˜å¯ä»¥ä¼ è¾“å›¾ç‰‡ï¼Œè§†é¢‘ç­‰ä»»æ„æ•°æ®ã€‚
2. **è¯·æ±‚-åº”ç­”æ¨¡å¼**ï¼Œé€šå¸¸è€Œè¨€ï¼Œå°±æ˜¯ä¸€æ–¹å‘é€æ¶ˆæ¯ï¼Œå¦å¤–ä¸€æ–¹è¦æ¥å—æ¶ˆæ¯ï¼Œæˆ–è€…æ˜¯åšå‡ºç›¸åº”ç­‰ã€‚
3. **å¯é ä¼ è¾“**ï¼ŒHTTPæ˜¯åŸºäºTCP/IPï¼Œå› æ­¤æŠŠè¿™ä¸€ç‰¹æ€§ç»§æ‰¿äº†ä¸‹æ¥ã€‚
4. **æ— çŠ¶æ€**ï¼Œè¿™ä¸ªåˆ†åœºæ™¯å›ç­”å³å¯ã€‚

### HTTP ç¼ºç‚¹

1. **æ— çŠ¶æ€**ï¼Œæœ‰æ—¶å€™ï¼Œéœ€è¦ä¿å­˜ä¿¡æ¯ï¼Œæ¯”å¦‚åƒè´­ç‰©ç³»ç»Ÿï¼Œéœ€è¦ä¿ç•™ä¸‹é¡¾å®¢ä¿¡æ¯ç­‰ç­‰ï¼Œå¦å¤–ä¸€æ–¹é¢ï¼Œæœ‰æ—¶å€™ï¼Œæ— çŠ¶æ€ä¹Ÿä¼šå‡å°‘ç½‘ç»œå¼€é”€ï¼Œæ¯”å¦‚ç±»ä¼¼ç›´æ’­è¡Œä¸šè¿™æ ·å­ç­‰ï¼Œè¿™ä¸ªè¿˜æ˜¯åˆ†åœºæ™¯æ¥è¯´ã€‚
2. **æ˜æ–‡ä¼ è¾“**ï¼Œå³åè®®é‡Œçš„æŠ¥æ–‡(ä¸»è¦æŒ‡çš„æ˜¯å¤´éƒ¨)ä¸ä½¿ç”¨äºŒè¿›åˆ¶æ•°æ®ï¼Œè€Œæ˜¯æ–‡æœ¬å½¢å¼ã€‚è¿™è®©HTTPçš„æŠ¥æ–‡ä¿¡æ¯æš´éœ²ç»™äº†å¤–ç•Œï¼Œç»™æ”»å‡»è€…å¸¦æ¥äº†ä¾¿åˆ©ã€‚
3. **é˜Ÿå¤´é˜»å¡**ï¼Œå½“httpå¼€å¯é•¿è¿æ¥æ—¶ï¼Œå…±ç”¨ä¸€ä¸ªTCPè¿æ¥ï¼Œå½“æŸä¸ªè¯·æ±‚æ—¶é—´è¿‡é•¿æ—¶ï¼Œå…¶ä»–çš„è¯·æ±‚åªèƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¿™å°±æ˜¯é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚





-------



## HTTP/1.0 HTTP1.1 HTTP2.0ç‰ˆæœ¬ä¹‹é—´çš„å·®å¼‚

### HTTP 0.9

- 1991å¹´,åŸå‹ç‰ˆæœ¬ï¼ŒåŠŸèƒ½ç®€é™‹ï¼Œåªæœ‰ä¸€ä¸ªå‘½ä»¤GET,åªæ”¯æŒçº¯æ–‡æœ¬å†…å®¹ï¼Œè¯¥ç‰ˆæœ¬å·²è¿‡æ—¶ã€‚



### HTTP 1.0

- ä»»ä½•æ ¼å¼çš„å†…å®¹éƒ½å¯ä»¥å‘é€ï¼Œè¿™ä½¿å¾—äº’è”ç½‘ä¸ä»…å¯ä»¥ä¼ è¾“æ–‡å­—ï¼Œè¿˜èƒ½ä¼ è¾“å›¾åƒã€è§†é¢‘ã€äºŒè¿›åˆ¶ç­‰æ–‡ä»¶ã€‚
- é™¤äº†GETå‘½ä»¤ï¼Œè¿˜å¼•å…¥äº†POSTå‘½ä»¤å’ŒHEADå‘½ä»¤ã€‚
- httpè¯·æ±‚å’Œå›åº”çš„æ ¼å¼æ”¹å˜ï¼Œé™¤äº†æ•°æ®éƒ¨åˆ†ï¼Œæ¯æ¬¡é€šä¿¡éƒ½å¿…é¡»åŒ…æ‹¬å¤´ä¿¡æ¯ï¼ˆHTTP headerï¼‰ï¼Œç”¨æ¥æè¿°ä¸€äº›å…ƒæ•°æ®ã€‚
- åªä½¿ç”¨ header ä¸­çš„ If-Modified-Since å’Œ Expires ä½œä¸ºç¼“å­˜å¤±æ•ˆçš„æ ‡å‡†ã€‚
- ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯æ¬¡éƒ½ä¼šä¼ é€å…¨éƒ¨çš„é¡µé¢å’Œæ•°æ®ã€‚
- é€šå¸¸æ¯å°è®¡ç®—æœºåªèƒ½ç»‘å®šä¸€ä¸ª IPï¼Œæ‰€ä»¥è¯·æ±‚æ¶ˆæ¯ä¸­çš„ URL å¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰

### HTTP 1.1

http1.1æ˜¯ç›®å‰æœ€ä¸ºä¸»æµçš„httpåè®®ç‰ˆæœ¬ï¼Œä»1999å¹´å‘å¸ƒè‡³ä»Šï¼Œä»æ˜¯ä¸»æµçš„httpåè®®ç‰ˆæœ¬ã€‚

- å¼•å…¥äº†æŒä¹…è¿æ¥ï¼ˆ persistent connectionï¼‰ï¼Œå³TCPè¿æ¥é»˜è®¤ä¸å…³é—­ï¼Œå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚å¤ç”¨ï¼Œä¸ç”¨å£°æ˜Connection: keep-aliveã€‚é•¿è¿æ¥çš„è¿æ¥æ—¶é•¿å¯ä»¥é€šè¿‡è¯·æ±‚å¤´ä¸­çš„ `keep-alive` æ¥è®¾ç½®
- å¼•å…¥äº†ç®¡é“æœºåˆ¶ï¼ˆ pipeliningï¼‰ï¼Œå³åœ¨åŒä¸€ä¸ªTCPè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å¯ä»¥åŒæ—¶å‘é€å¤šä¸ª
  è¯·æ±‚ï¼Œè¿›ä¸€æ­¥æ”¹è¿›äº†HTTPåè®®çš„æ•ˆç‡ã€‚
- HTTP 1.1 ä¸­æ–°å¢åŠ äº† E-tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Match ç­‰ç¼“å­˜æ§åˆ¶æ ‡å¤´æ¥æ§åˆ¶ç¼“å­˜å¤±æ•ˆã€‚
- æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œé€šè¿‡ä½¿ç”¨è¯·æ±‚å¤´ä¸­çš„ `Range` æ¥å®ç°ã€‚
- ä½¿ç”¨äº†è™šæ‹Ÿç½‘ç»œï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼ˆMulti-homed Web Serversï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ªIPåœ°å€ã€‚
- æ–°å¢æ–¹æ³•ï¼šPUTã€ PATCHã€ OPTIONSã€ DELETEã€‚



### http1.xç‰ˆæœ¬é—®é¢˜

- åœ¨ä¼ è¾“æ•°æ®è¿‡ç¨‹ä¸­ï¼Œæ‰€æœ‰å†…å®¹éƒ½æ˜¯æ˜æ–‡ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯éƒ½æ— æ³•éªŒè¯å¯¹æ–¹çš„èº«ä»½ï¼Œæ— æ³•ä¿è¯æ•°æ®çš„å®‰å…¨æ€§ã€‚
- HTTP/1.1 ç‰ˆæœ¬é»˜è®¤å…è®¸å¤ç”¨TCPè¿æ¥ï¼Œä½†æ˜¯åœ¨åŒä¸€ä¸ªTCPè¿æ¥é‡Œï¼Œæ‰€æœ‰æ•°æ®é€šä¿¡æ˜¯æŒ‰æ¬¡åºè¿›è¡Œçš„ï¼ŒæœåŠ¡å™¨é€šå¸¸åœ¨å¤„ç†å®Œä¸€ä¸ªå›åº”åï¼Œæ‰ä¼šç»§ç»­å»å¤„ç†ä¸‹ä¸€ä¸ªï¼Œè¿™æ ·å­å°±ä¼šé€ æˆé˜Ÿå¤´é˜»å¡ã€‚
- http/1.x ç‰ˆæœ¬æ”¯æŒKeep-aliveï¼Œç”¨æ­¤æ–¹æ¡ˆæ¥å¼¥è¡¥åˆ›å»ºå¤šæ¬¡è¿æ¥äº§ç”Ÿçš„å»¶è¿Ÿï¼Œä½†æ˜¯åŒæ ·ä¼šç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ï¼Œå¹¶ä¸”çš„è¯ï¼Œå¯¹äºå•æ–‡ä»¶è¢«ä¸æ–­è¯·æ±‚çš„æœåŠ¡ï¼ŒKeep-aliveä¼šæå¤§å½±å“æ€§èƒ½ï¼Œå› ä¸ºå®ƒåœ¨æ–‡ä»¶è¢«è¯·æ±‚ä¹‹åè¿˜ä¿æŒäº†ä¸å¿…è¦çš„è¿æ¥å¾ˆé•¿æ—¶é—´ã€‚



### HTTP 2.0

- `äºŒè¿›åˆ¶åˆ†å¸§`  è¿™æ˜¯ä¸€æ¬¡å½»åº•çš„äºŒè¿›åˆ¶åè®®ï¼Œå¤´ä¿¡æ¯å’Œæ•°æ®ä½“éƒ½æ˜¯äºŒè¿›åˆ¶ï¼Œå¹¶ä¸”ç»Ÿç§°ä¸º"å¸§"ï¼šå¤´ä¿¡æ¯å¸§å’Œæ•°æ®å¸§ã€‚
- `å¤´éƒ¨å‹ç¼©`  HTTP 1.1ç‰ˆæœ¬ä¼šå‡ºç° **User-Agentã€Cookieã€Acceptã€Serverã€Range** ç­‰å­—æ®µå¯èƒ½ä¼šå ç”¨å‡ ç™¾ç”šè‡³å‡ åƒå­—èŠ‚ï¼Œè€Œ Body å´ç»å¸¸åªæœ‰å‡ åå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´å¤´éƒ¨åé‡ã€‚HTTP 2.0 ä½¿ç”¨ `HPACK` ç®—æ³•è¿›è¡Œå‹ç¼©ã€‚
- `å¤šè·¯å¤ç”¨` å¤ç”¨TCPè¿æ¥ï¼Œåœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’Œæµè§ˆå™¨éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œä¸”ä¸ç”¨æŒ‰é¡ºåºä¸€ä¸€å¯¹åº”ï¼Œè¿™æ ·å­è§£å†³äº†é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚
- `æœåŠ¡å™¨æ¨é€` å…è®¸æœåŠ¡å™¨æœªç»è¯·æ±‚ï¼Œä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€èµ„æºï¼Œå³æœåŠ¡å™¨æ¨é€ã€‚
- `è¯·æ±‚ä¼˜å…ˆçº§` å¯ä»¥è®¾ç½®æ•°æ®å¸§çš„ä¼˜å…ˆçº§ï¼Œè®©æœåŠ¡ç«¯å…ˆå¤„ç†é‡è¦èµ„æºï¼Œä¼˜åŒ–ç”¨æˆ·ä½“éªŒã€‚







-----------------------



## è°ˆä¸€è°ˆä½ å¯¹HTTP/2ç†è§£ 

### å¤´éƒ¨å‹ç¼©

HTTP 1.1ç‰ˆæœ¬ä¼šå‡ºç° **User-Agentã€Cookieã€Acceptã€Serverã€Range** ç­‰å­—æ®µå¯èƒ½ä¼šå ç”¨å‡ ç™¾ç”šè‡³å‡ åƒå­—èŠ‚ï¼Œè€Œ Body å´ç»å¸¸åªæœ‰å‡ åå­—èŠ‚ï¼Œæ‰€ä»¥å¯¼è‡´å¤´éƒ¨åé‡ã€‚

HTTP 2.0 ä½¿ç”¨ `HPACK` ç®—æ³•è¿›è¡Œå‹ç¼©ã€‚





## ä»‹ç»ä¸€ä¸‹HTTP å¸¸è§çŠ¶æ€ç 

RFC è§„å®š HTTP çš„çŠ¶æ€ç ä¸º**ä¸‰ä½æ•°**ï¼Œç¬¬ä¸€ä¸ªæ•°å­—å®šä¹‰äº†å“åº”çš„ç±»åˆ«ï¼Œè¢«åˆ†ä¸ºäº”ç±»:

- **1xx**: ä»£è¡¨è¯·æ±‚å·²è¢«æ¥å—ï¼Œéœ€è¦ç»§ç»­å¤„ç†ã€‚
- **2xx**: è¡¨ç¤ºæˆåŠŸçŠ¶æ€ã€‚
- **3xx**: é‡å®šå‘çŠ¶æ€ã€‚
- **4xx**: å®¢æˆ·ç«¯é”™è¯¯ã€‚
- **5xx**: æœåŠ¡å™¨ç«¯é”™è¯¯ã€‚



### 1xx ä¿¡æ¯ç±»

æ¥å—çš„è¯·æ±‚æ­£åœ¨å¤„ç†ï¼Œä¿¡æ¯ç±»çŠ¶æ€ç ã€‚

### 2xx æˆåŠŸ

- 200 OK è¡¨ç¤ºä»å®¢æˆ·ç«¯å‘æ¥çš„è¯·æ±‚åœ¨æœåŠ¡å™¨ç«¯è¢«æ­£ç¡®è¯·æ±‚ã€‚
- 204 No contentï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œä½†æ²¡æœ‰èµ„æºå¯è¿”å›ã€‚
- 206 Partial Contentï¼Œè¯¥çŠ¶æ€ç è¡¨ç¤ºå®¢æˆ·ç«¯è¿›è¡Œäº†èŒƒå›´è¯·æ±‚ï¼Œè€ŒæœåŠ¡å™¨æˆåŠŸæ‰§è¡Œäº†è¿™éƒ¨åˆ†çš„ GET è¯·æ±‚
  å“åº”æŠ¥æ–‡ä¸­åŒ…å«ç”± **Content-Range** æŒ‡å®šèŒƒå›´çš„å®ä½“å†…å®¹ã€‚



### 3xx é‡å®šå‘

- 301 moved permanentlyï¼Œæ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºå·²è¢«åˆ†é…äº†æ–°çš„ URLï¼Œè¿™æ—¶åº”è¯¥æŒ‰ Location é¦–éƒ¨å­—æ®µæç¤ºçš„ URI é‡æ–°ä¿å­˜ã€‚
- 302 foundï¼Œä¸´æ—¶æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºèµ„æºä¸´æ—¶è¢«åˆ†é…äº†æ–°çš„ URLã€‚
- 303 see otherï¼Œè¡¨ç¤ºèµ„æºå­˜åœ¨ç€å¦ä¸€ä¸ª URLï¼Œåº”ä½¿ç”¨ GET æ–¹æ³•è·å–èµ„æºã€‚
- 304 not modifiedï¼Œå½“åå•†ç¼“å­˜å‘½ä¸­æ—¶ä¼šè¿”å›è¿™ä¸ªçŠ¶æ€ç ã€‚
- 307 temporary redirectï¼Œä¸´æ—¶é‡å®šå‘ï¼Œå’Œ302å«ä¹‰ç›¸åŒ,ä¸ä¼šæ”¹å˜method



>å½“ 301ã€302ã€303 å“åº”çŠ¶æ€ç è¿”å›æ—¶ï¼Œå‡ ä¹æ‰€æœ‰çš„æµè§ˆå™¨éƒ½ä¼šæŠŠ POST æ”¹æˆ GETï¼Œå¹¶åˆ é™¤è¯·æ±‚æŠ¥æ–‡å†…çš„ä¸»ä½“ï¼Œä¹‹åè¯·æ±‚ä¼šè‡ªåŠ¨å†æ¬¡å‘é€
>301ã€302 æ ‡å‡†æ˜¯ç¦æ­¢å°† POST æ–¹æ³•æ”¹å˜æˆ GET æ–¹æ³•çš„ï¼Œä½†å®é™…ä½¿ç”¨æ—¶å¤§å®¶éƒ½ä¼šè¿™ä¹ˆåš



### 4XX å®¢æˆ·ç«¯é”™è¯¯

- 400 bad requestï¼Œè¯·æ±‚æŠ¥æ–‡å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚
- 401 unauthorizedï¼Œè¡¨ç¤ºå‘é€çš„è¯·æ±‚éœ€è¦æœ‰é€šè¿‡ HTTP è®¤è¯çš„è®¤è¯ä¿¡æ¯ã€‚
- 403 forbiddenï¼Œè¡¨ç¤ºå¯¹è¯·æ±‚èµ„æºçš„è®¿é—®è¢«æœåŠ¡å™¨æ‹’ç»ã€‚
- 404 not foundï¼Œè¡¨ç¤ºåœ¨æœåŠ¡å™¨ä¸Šæ²¡æœ‰æ‰¾åˆ°è¯·æ±‚çš„èµ„æºã€‚
- 405 Method Not Allowedï¼ŒæœåŠ¡å™¨ç¦æ­¢ä½¿ç”¨è¯¥æ–¹æ³•ï¼Œå®¢æˆ·ç«¯å¯ä»¥é€šè¿‡optionsæ–¹æ³•æ¥æŸ¥çœ‹æœåŠ¡å™¨å…è®¸çš„è®¿é—®æ–¹æ³•ï¼Œå¦‚ä¸‹ ğŸ‘‡

```
Access-Control-Allow-Methods â†’GET,HEAD,PUT,PATCH,POST,DELETE
```



### 5XX æœåŠ¡å™¨é”™è¯¯

- 500 internal sever errorï¼Œè¡¨ç¤ºæœåŠ¡å™¨ç«¯åœ¨æ‰§è¡Œè¯·æ±‚æ—¶å‘ç”Ÿäº†é”™è¯¯ã€‚
- 502 Bad Gatewayï¼ŒæœåŠ¡å™¨è‡ªèº«æ˜¯æ­£å¸¸çš„ï¼Œè®¿é—®çš„æ—¶å€™å‡ºäº†é—®é¢˜ï¼Œå…·ä½“å•¥é”™è¯¯æˆ‘ä»¬ä¸çŸ¥é“ã€‚
- 503 service unavailableï¼Œè¡¨æ˜æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨åœæœºç»´æŠ¤ï¼Œæ— æ³•å¤„ç†è¯·æ±‚ã€‚





------



## ä»‹ç»ä¸€ä¸‹Connectionä¸ºkeep-aliveè¡¨ç¤ºä»€ä¹ˆ

### ä»€ä¹ˆæ˜¯keep-alive

æˆ‘ä»¬çŸ¥é“HTTPåè®®é‡‡ç”¨â€œè¯·æ±‚-åº”ç­”â€æ¨¡å¼ï¼Œå½“ä½¿ç”¨æ™®é€šæ¨¡å¼ï¼Œå³éKeepAliveæ¨¡å¼æ—¶ï¼Œæ¯ä¸ªè¯·æ±‚/åº”ç­”å®¢æˆ·å’ŒæœåŠ¡å™¨éƒ½è¦æ–°å»ºä¸€ä¸ªè¿æ¥ï¼Œå®Œæˆ ä¹‹åç«‹å³æ–­å¼€è¿æ¥ï¼ˆHTTPåè®®ä¸ºæ— è¿æ¥çš„åè®®ï¼‰ï¼›

å½“ä½¿ç”¨Keep-Aliveæ¨¡å¼ï¼ˆåˆç§°æŒä¹…è¿æ¥ã€è¿æ¥é‡ç”¨ï¼‰æ—¶ï¼ŒKeep-AliveåŠŸèƒ½ä½¿å®¢æˆ·ç«¯åˆ°æœ åŠ¡å™¨ç«¯çš„è¿æ¥æŒç»­æœ‰æ•ˆï¼Œå½“å‡ºç°å¯¹æœåŠ¡å™¨çš„åç»§è¯·æ±‚æ—¶ï¼ŒKeep-AliveåŠŸèƒ½é¿å…äº†å»ºç«‹æˆ–è€…é‡æ–°å»ºç«‹è¿æ¥ã€‚



### ä¸ºä»€ä¹ˆè¦ä½¿ç”¨keep-alive

keep-aliveæŠ€æœ¯çš„åˆ›å»ºç›®çš„ï¼Œèƒ½åœ¨å¤šæ¬¡HTTPä¹‹å‰é‡ç”¨åŒä¸€ä¸ªTCPè¿æ¥ï¼Œä»è€Œå‡å°‘åˆ›å»º/å…³é—­å¤šä¸ª TCP è¿æ¥çš„å¼€é”€ï¼ˆåŒ…æ‹¬å“åº”æ—¶é—´ã€CPU èµ„æºã€å‡å°‘æ‹¥å µç­‰ï¼‰ï¼Œå‚è€ƒå¦‚ä¸‹ç¤ºæ„å›¾ï¼ˆæ¥æºï¼šç»´åŸºç™¾ç§‘ï¼‰ï¼š

![](C:\Users\DayDay\Desktop\Blog\images\http\keep-alive-demonstration.svg)





### å®¢æˆ·ç«¯å¦‚ä½•å¼€å¯

åœ¨HTTP/1.0åè®®ä¸­ï¼Œé»˜è®¤æ˜¯å…³é—­çš„ï¼Œéœ€è¦åœ¨httpå¤´åŠ å…¥"Connection: Keep-Aliveâ€ï¼Œæ‰èƒ½å¯ç”¨Keep-Aliveï¼›

```
Connection: keep-alive
```

http 1.1ä¸­é»˜è®¤å¯ç”¨Keep-Aliveï¼Œå¦‚æœåŠ å…¥"Connection: close â€œï¼Œæ‰å…³é—­ã€‚

```
Connection: close
```

ç›®å‰å¤§éƒ¨åˆ†æµè§ˆå™¨éƒ½æ˜¯ç”¨http1.1åè®®ï¼Œä¹Ÿå°±æ˜¯è¯´é»˜è®¤éƒ½ä¼šå‘èµ·Keep-Aliveçš„è¿æ¥è¯·æ±‚äº†ï¼Œæ‰€ä»¥æ˜¯å¦èƒ½å®Œæˆä¸€ä¸ªå®Œæ•´çš„Keep- Aliveè¿æ¥å°±çœ‹æœåŠ¡å™¨è®¾ç½®æƒ…å†µã€‚





---------------





## ä»‹ç»HTTP ç¼“å­˜ç­–ç•¥

è¿™ä¸ªè·Ÿä¹‹å‰çš„æµè§ˆå™¨ç¼“å­˜åŸç†ä¸€æ ·ï¼Œæˆ‘ç›´æ¥æ‹¿æˆ‘ä¹‹å‰æ¢³ç†è¿‡çš„å§ã€‚

æˆ‘åœ¨æˆ‘ä¹‹å‰çš„é‚£ä¸€ç¯‡ä¸­å·²ç»è¯¦ç»†çš„è¯´è¿‡äº†ï¼Œ[ç‚¹è¿™é‡Œä¼ é€é—¨èŠä¸€èŠæµè§ˆå™¨ç¼“å­˜](https://juejin.im/post/5f184aade51d4534aa4ad7c0#heading-40)

æˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹å§ğŸ‘‡



### å¼ºç¼“å­˜

å¼ºç¼“å­˜ä¸¤ä¸ªç›¸å…³å­—æ®µï¼Œ**Expires**ï¼Œ**Cache-Control**ã€‚

**å¼ºç¼“å­˜åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯å‘é€HTTPè¯·æ±‚ï¼Œä¸€ç§ä¸éœ€è¦å‘é€ã€‚**

é¦–å…ˆæ£€æŸ¥å¼ºç¼“å­˜ï¼Œè¿™ä¸ªé˜¶æ®µ**ä¸éœ€è¦å‘é€HTTPè¯·æ±‚ã€‚**é€šè¿‡æŸ¥æ‰¾ä¸åŒçš„å­—æ®µæ¥è¿›è¡Œï¼Œä¸åŒçš„HTTPç‰ˆæœ¬æ‰€ä»¥ä¸åŒã€‚

- HTTP1.0ç‰ˆæœ¬ï¼Œä½¿ç”¨çš„æ˜¯Expiresï¼ŒHTTP1.1ä½¿ç”¨çš„æ˜¯Cache-Control



#### Expires

`Expires`å³è¿‡æœŸæ—¶é—´ï¼Œæ—¶é—´æ˜¯ç›¸å¯¹äºæœåŠ¡å™¨çš„æ—¶é—´è€Œè¨€çš„ï¼Œå­˜åœ¨äºæœåŠ¡ç«¯è¿”å›çš„å“åº”å¤´ä¸­ï¼Œåœ¨è¿™ä¸ªè¿‡æœŸæ—¶é—´ä¹‹å‰å¯ä»¥ç›´æ¥ä»ç¼“å­˜é‡Œé¢è·å–æ•°æ®ï¼Œæ— éœ€å†æ¬¡è¯·æ±‚ã€‚æ¯”å¦‚ä¸‹é¢è¿™æ ·:

```
Expires:Mon, 29 Jun 2020 11:10:23 GMT
```

è¡¨ç¤ºè¯¥èµ„æºåœ¨2020å¹´`7æœˆ29æ—¥11:10:23`è¿‡æœŸï¼Œè¿‡æœŸæ—¶å°±ä¼šé‡æ–°å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚ã€‚

è¿™ä¸ªæ–¹å¼æœ‰ä¸€ä¸ªé—®é¢˜ï¼š**æœåŠ¡å™¨çš„æ—¶é—´å’Œæµè§ˆå™¨çš„æ—¶é—´å¯èƒ½å¹¶ä¸ä¸€è‡´**ï¼Œæ‰€ä»¥HTTP1.1æå‡ºæ–°çš„å­—æ®µä»£æ›¿å®ƒã€‚

#### Cache-Control

HTTP1.1ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨çš„å°±æ˜¯è¯¥å­—æ®µï¼Œè¿™ä¸ªå­—æ®µé‡‡ç”¨çš„æ—¶é—´æ˜¯è¿‡æœŸæ—¶é•¿ï¼Œå¯¹åº”çš„æ˜¯max-ageã€‚

```
Cache-Control:max-age=6000
```

ä¸Šé¢ä»£è¡¨è¯¥èµ„æºè¿”å›å6000ç§’ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜ã€‚

å½“ç„¶äº†ï¼Œå®ƒè¿˜æœ‰å…¶ä»–å¾ˆå¤šå…³é”®çš„æŒ‡ä»¤ï¼Œæ¢³ç†äº†å‡ ä¸ªé‡è¦çš„ğŸ‘‡



æ³¨æ„ç‚¹ï¼š

- å½“Expireså’ŒCache-ControlåŒæ—¶å­˜åœ¨æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘Cache-Controlã€‚
- å½“ç„¶äº†ï¼Œå½“ç¼“å­˜èµ„æºå¤±æ•ˆäº†ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰å‘½ä¸­å¼ºç¼“å­˜ï¼Œæ¥ä¸‹æ¥å°±è¿›å…¥åå•†ç¼“å­˜ğŸ‘‡



### åå•†ç¼“å­˜

å¼ºç¼“å­˜å¤±æ•ˆåï¼Œæµè§ˆå™¨åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦å“åº”çš„`ç¼“å­˜Tag`æ¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨æ ¹æ®å¯¹åº”çš„tagï¼Œæ¥å†³å®šæ˜¯å¦ä½¿ç”¨ç¼“å­˜ã€‚

ç¼“å­˜åˆ†ä¸ºä¸¤ç§ï¼Œ**Last-Modified** å’Œ **ETag**ã€‚ä¸¤è€…å„æœ‰ä¼˜åŠ¿ï¼Œå¹¶ä¸å­˜åœ¨è°å¯¹è°æœ‰`ç»å¯¹çš„ä¼˜åŠ¿`ï¼Œä¸ä¸Šé¢æ‰€è®²çš„å¼ºç¼“å­˜ä¸¤ä¸ªTagæ‰€ä¸åŒã€‚

#### Last-Modified

è¿™ä¸ªå­—æ®µè¡¨ç¤ºçš„æ˜¯**æœ€åä¿®æ”¹æ—¶é—´**ã€‚åœ¨æµè§ˆå™¨ç¬¬ä¸€æ¬¡ç»™æœåŠ¡å™¨å‘é€è¯·æ±‚åï¼ŒæœåŠ¡å™¨ä¼šåœ¨å“åº”å¤´ä¸­åŠ ä¸Šè¿™ä¸ªå­—æ®µã€‚

æµè§ˆå™¨æ¥æ”¶åˆ°åï¼Œ**å¦‚æœå†æ¬¡è¯·æ±‚**ï¼Œä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦`If-Modified-Since`å­—æ®µï¼Œè¿™ä¸ªå­—æ®µçš„å€¼ä¹Ÿå°±æ˜¯æœåŠ¡å™¨ä¼ æ¥çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚

æœåŠ¡å™¨æ‹¿åˆ°è¯·æ±‚å¤´ä¸­çš„`If-Modified-Since`çš„å­—æ®µåï¼Œå…¶å®ä¼šå’Œè¿™ä¸ªæœåŠ¡å™¨ä¸­`è¯¥èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´`å¯¹æ¯”:

- å¦‚æœè¯·æ±‚å¤´ä¸­çš„è¿™ä¸ªå€¼å°äºæœ€åä¿®æ”¹æ—¶é—´ï¼Œè¯´æ˜æ˜¯æ—¶å€™æ›´æ–°äº†ã€‚è¿”å›æ–°çš„èµ„æºï¼Œè·Ÿå¸¸è§„çš„HTTPè¯·æ±‚å“åº”çš„æµç¨‹ä¸€æ ·ã€‚
- å¦åˆ™è¿”å›304ï¼Œå‘Šè¯‰æµè§ˆå™¨ç›´æ¥ä½¿ç”¨ç¼“å­˜ã€‚





#### ETag

ETagæ˜¯æœåŠ¡å™¨æ ¹æ®å½“å‰æ–‡ä»¶çš„å†…å®¹ï¼Œå¯¹æ–‡ä»¶ç”Ÿæˆå”¯ä¸€çš„æ ‡è¯†ï¼Œæ¯”å¦‚MD5ç®—æ³•ï¼Œåªè¦é‡Œé¢çš„å†…å®¹æœ‰æ”¹åŠ¨ï¼Œè¿™ä¸ªå€¼å°±ä¼šä¿®æ”¹ï¼ŒæœåŠ¡å™¨é€šè¿‡æŠŠå“åº”å¤´æŠŠè¯¥å­—æ®µç»™æµè§ˆå™¨ã€‚

æµè§ˆå™¨æ¥å—åˆ°ETagå€¼ï¼Œä¼šåœ¨ä¸‹æ¬¡è¯·æ±‚çš„æ—¶å€™ï¼Œå°†è¿™ä¸ªå€¼ä½œä¸º**If-None-Match**è¿™ä¸ªå­—æ®µçš„å†…å®¹ï¼Œå‘ç»™æœåŠ¡å™¨ã€‚

æœåŠ¡å™¨æ¥æ”¶åˆ°**If-None-Match**åï¼Œä¼šè·ŸæœåŠ¡å™¨ä¸Šè¯¥èµ„æºçš„**ETag**è¿›è¡Œæ¯”å¯¹ğŸ‘‡

- å¦‚æœä¸¤è€…ä¸€æ ·çš„è¯ï¼Œç›´æ¥è¿”å›304ï¼Œå‘Šè¯‰æµè§ˆå™¨ç›´æ¥ä½¿ç”¨ç¼“å­˜
- å¦‚æœä¸ä¸€æ ·çš„è¯ï¼Œè¯´æ˜å†…å®¹æ›´æ–°äº†ï¼Œè¿”å›æ–°çš„èµ„æºï¼Œè·Ÿå¸¸è§„çš„HTTPè¯·æ±‚å“åº”çš„æµç¨‹ä¸€æ ·



#### ä¸¤è€…å¯¹æ¯”

- æ€§èƒ½ä¸Šï¼Œ`Last-Modified`ä¼˜äº`ETag`ï¼Œ`Last-Modified`è®°å½•çš„æ˜¯æ—¶é—´ç‚¹ï¼Œè€Œ`Etag`éœ€è¦æ ¹æ®æ–‡ä»¶çš„MD5ç®—æ³•ç”Ÿæˆå¯¹åº”çš„hashå€¼ã€‚
- ç²¾åº¦ä¸Šï¼Œ`ETag`ä¼˜äº`Last-Modified`ã€‚`ETag`æŒ‰ç…§å†…å®¹ç»™èµ„æºå¸¦ä¸Šæ ‡è¯†ï¼Œèƒ½å‡†ç¡®æ„ŸçŸ¥èµ„æºå˜åŒ–ï¼Œ`Last-Modified`åœ¨æŸäº›åœºæ™¯å¹¶ä¸èƒ½å‡†ç¡®æ„ŸçŸ¥å˜åŒ–ï¼Œæ¯”å¦‚ğŸ‘‡
  - ç¼–è¾‘äº†èµ„æºæ–‡ä»¶ï¼Œä½†æ˜¯æ–‡ä»¶å†…å®¹å¹¶æ²¡æœ‰æ›´æ”¹ï¼Œè¿™æ ·ä¹Ÿä¼šé€ æˆç¼“å­˜å¤±æ•ˆã€‚
  - Last-Modified èƒ½å¤Ÿæ„ŸçŸ¥çš„å•ä½æ—¶é—´æ˜¯ç§’ï¼Œå¦‚æœæ–‡ä»¶åœ¨ 1 ç§’å†…æ”¹å˜äº†å¤šæ¬¡ï¼Œé‚£ä¹ˆè¿™æ—¶å€™çš„ Last-Modified å¹¶æ²¡æœ‰ä½“ç°å‡ºä¿®æ”¹äº†ã€‚



æœ€åï¼Œ**å¦‚æœä¸¤ç§æ–¹å¼éƒ½æ”¯æŒçš„è¯ï¼ŒæœåŠ¡å™¨ä¼šä¼˜å…ˆè€ƒè™‘`ETag`**ã€‚



### ç¼“å­˜ä½ç½®

æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ç¼“å­˜çš„è¯ï¼Œç¼“å­˜çš„ä½ç½®åœ¨å“ªé‡Œå‘¢ï¼Ÿ

æµè§ˆå™¨ç¼“å­˜çš„ä½ç½®çš„è¯ï¼Œå¯ä»¥åˆ†ä¸ºå››ç§,ä¼˜å…ˆçº§ä»é«˜åˆ°ä½æ’åˆ—åˆ†åˆ«ğŸ‘‡

- Service Worker
- Memory Cache
- Disk Cache
- Push Cache

#### Service Worker

è¿™ä¸ªåº”ç”¨åœºæ™¯æ¯”å¦‚PWAï¼Œå®ƒå€Ÿé‰´äº†Web Workeræ€è·¯ï¼Œç”±äºå®ƒè„±ç¦»äº†æµè§ˆå™¨çš„çª—ä½“ï¼Œå› æ­¤æ— æ³•ç›´æ¥è®¿é—®DOMã€‚å®ƒèƒ½å®Œæˆçš„åŠŸèƒ½æ¯”å¦‚ï¼š`ç¦»çº¿ç¼“å­˜`ã€`æ¶ˆæ¯æ¨é€`å’Œ`ç½‘ç»œä»£ç†`ï¼Œå…¶ä¸­`ç¦»çº¿ç¼“å­˜`å°±æ˜¯**Service Worker Cache**ã€‚



#### Memory Cache

æŒ‡çš„æ˜¯å†…å­˜ç¼“å­˜ï¼Œä»æ•ˆç‡ä¸Šè®²å®ƒæ˜¯æœ€å¿«çš„ï¼Œä»å­˜æ´»æ—¶é—´æ¥è®²åˆæ˜¯æœ€çŸ­çš„ï¼Œå½“æ¸²æŸ“è¿›ç¨‹ç»“æŸåï¼Œå†…å­˜ç¼“å­˜ä¹Ÿå°±ä¸å­˜åœ¨äº†ã€‚

#### Disk Cache

å­˜å‚¨åœ¨ç£ç›˜ä¸­çš„ç¼“å­˜ï¼Œä»å­˜å–æ•ˆç‡ä¸Šè®²æ˜¯æ¯”å†…å­˜ç¼“å­˜æ…¢çš„ï¼Œä¼˜åŠ¿åœ¨äºå­˜å‚¨å®¹é‡å’Œå­˜å‚¨æ—¶é•¿ã€‚



#### Disk Cache VS Memory Cache

ä¸¤è€…å¯¹æ¯”ï¼Œä¸»è¦çš„ç­–ç•¥ğŸ‘‡

å†…å®¹ä½¿ç”¨ç‡é«˜çš„è¯ï¼Œæ–‡ä»¶ä¼˜å…ˆè¿›å…¥ç£ç›˜

æ¯”è¾ƒå¤§çš„JSï¼ŒCSSæ–‡ä»¶ä¼šç›´æ¥æ”¾å…¥ç£ç›˜ï¼Œåä¹‹æ”¾å…¥å†…å­˜ã€‚



#### Push Cache

æ¨é€ç¼“å­˜ï¼Œè¿™ç®—æ˜¯æµè§ˆå™¨ä¸­æœ€åä¸€é“é˜²çº¿å§ï¼Œå®ƒæ˜¯`HTTP/2`çš„å†…å®¹ã€‚å…·ä½“æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œæœ‰å…´è¶£çš„å¯ä»¥å»äº†è§£ã€‚



### æ€»ç»“

- é¦–å…ˆæ£€æŸ¥`Cache-Control`ï¼Œ å°é²œï¼Œçœ‹å¼ºç¼“å­˜æ˜¯å¦å¯ç”¨
- å¦‚æœå¯ç”¨çš„è¯ï¼Œç›´æ¥ä½¿ç”¨
- å¦åˆ™è¿›å…¥åå•†ç¼“å­˜ï¼Œå‘é€HTTPè¯·æ±‚ï¼ŒæœåŠ¡å™¨é€šè¿‡è¯·æ±‚å¤´ä¸­çš„`If-Modified-Since`æˆ–è€…`If-None-Match`å­—æ®µæ£€æŸ¥èµ„æºæ˜¯å¦æ›´æ–°
- èµ„æºæ›´æ–°ï¼Œè¿”å›èµ„æºå’Œ200çŠ¶æ€ç ã€‚
- å¦åˆ™ï¼Œè¿”å›304ï¼Œç›´æ¥å‘Šè¯‰æµè§ˆå™¨ç›´æ¥ä»ç¼“å­˜ä¸­å»èµ„æºã€‚



------



## è¯´ä¸€è¯´HTTP çš„è¯·æ±‚æ–¹æ³•ï¼Ÿ

- HTTP1.0å®šä¹‰äº†ä¸‰ç§è¯·æ±‚æ–¹æ³•ï¼š GET, POST å’Œ HEADæ–¹æ³•
- HTTP1.1æ–°å¢äº†äº”ç§è¯·æ±‚æ–¹æ³•ï¼šOPTIONS, PUT, DELETE, TRACE å’Œ CONNECT

`http/1.1`è§„å®šäº†ä»¥ä¸‹è¯·æ±‚æ–¹æ³•(æ³¨æ„ï¼Œéƒ½æ˜¯å¤§å†™):

- GETï¼š                è¯·æ±‚è·å–Request-URIæ‰€æ ‡è¯†çš„èµ„æº
- POSTï¼š              åœ¨Request-URIæ‰€æ ‡è¯†çš„èµ„æºåé™„åŠ æ–°çš„æ•°æ®
- HEADï¼š             è¯·æ±‚è·å–ç”±Request-URIæ‰€æ ‡è¯†çš„èµ„æºçš„å“åº”æ¶ˆæ¯æŠ¥å¤´
- PUTï¼š                è¯·æ±‚æœåŠ¡å™¨å­˜å‚¨ä¸€ä¸ªèµ„æºï¼Œå¹¶ç”¨Request-URIä½œä¸ºå…¶æ ‡è¯†ï¼ˆä¿®æ”¹æ•°æ®ï¼‰
- DELETEï¼š          è¯·æ±‚æœåŠ¡å™¨åˆ é™¤å¯¹åº”æ‰€æ ‡è¯†çš„èµ„æº
- TRACEï¼š            è¯·æ±‚æœåŠ¡å™¨å›é€æ”¶åˆ°çš„è¯·æ±‚ä¿¡æ¯ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­
- CONNECTï¼š      å»ºç«‹è¿æ¥éš§é“ï¼Œç”¨äºä»£ç†æœåŠ¡å™¨
- OPTIONSï¼š       åˆ—å‡ºå¯å¯¹èµ„æºå®è¡Œçš„è¯·æ±‚æ–¹æ³•ï¼Œç”¨æ¥è·¨åŸŸè¯·æ±‚



---------



## è°ˆä¸€è°ˆGET å’Œ POST çš„åŒºåˆ«

æœ¬è´¨ä¸Šï¼Œåªæ˜¯è¯­ä¹‰ä¸Šçš„åŒºåˆ«ï¼ŒGET ç”¨äºè·å–èµ„æºï¼ŒPOST ç”¨äºæäº¤èµ„æºã€‚

æƒ³è£…é€¼è¯·å‚è€ƒ https://zhuanlan.zhihu.com/p/22536382

å…·ä½“å·®åˆ«ğŸ‘‡

- ä»ç¼“å­˜è§’åº¦çœ‹ï¼ŒGET è¯·æ±‚åæµè§ˆå™¨ä¼šä¸»åŠ¨ç¼“å­˜ï¼ŒPOST é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ã€‚
- ä»å‚æ•°è§’åº¦æ¥çœ‹ï¼ŒGETè¯·æ±‚ä¸€èˆ¬æ”¾åœ¨URLä¸­ï¼Œå› æ­¤ä¸å®‰å…¨ï¼ŒPOSTè¯·æ±‚æ”¾åœ¨è¯·æ±‚ä½“ä¸­ï¼Œç›¸å¯¹è€Œè¨€è¾ƒä¸ºå®‰å…¨ï¼Œä½†æ˜¯åœ¨æŠ“åŒ…çš„æƒ…å†µä¸‹éƒ½æ˜¯ä¸€æ ·çš„ã€‚
- ä»ç¼–ç è§’åº¦çœ‹ï¼ŒGETè¯·æ±‚åªèƒ½ç»è¡ŒURLç¼–ç ï¼Œåªèƒ½æ¥å—ASCIIç ï¼Œè€ŒPOSTæ”¯æŒæ›´å¤šçš„ç¼–ç ç±»å‹ä¸”ä¸å¯¹æ•°æ®ç±»å‹é™å€¼ã€‚
- GETè¯·æ±‚å¹‚ç­‰ï¼ŒPOSTè¯·æ±‚ä¸å¹‚ç­‰ï¼Œå¹‚ç­‰æŒ‡å‘é€ M å’Œ N æ¬¡è¯·æ±‚ï¼ˆä¸¤è€…ä¸ç›¸åŒä¸”éƒ½å¤§äº1ï¼‰ï¼ŒæœåŠ¡å™¨ä¸Šèµ„æºçš„çŠ¶æ€ä¸€è‡´ã€‚
- GETè¯·æ±‚ä¼šä¸€æ¬¡æ€§å‘é€è¯·æ±‚æŠ¥æ–‡ï¼ŒPOSTè¯·æ±‚é€šå¸¸åˆ†ä¸ºä¸¤ä¸ªTCPæ•°æ®åŒ…ï¼Œé¦–å…ˆå‘ header éƒ¨åˆ†ï¼Œå¦‚æœæœåŠ¡å™¨å“åº” 100(continue)ï¼Œ ç„¶åå‘ body éƒ¨åˆ†ã€‚



ä»åº”ç”¨åœºæ™¯è§’åº¦æ¥çœ‹ï¼ŒGet å¤šç”¨äºæ— å‰¯ä½œç”¨ï¼Œå¹‚ç­‰çš„åœºæ™¯ï¼Œä¾‹å¦‚æœç´¢å…³é”®å­—ã€‚Post å¤šç”¨äºå‰¯ä½œç”¨ï¼Œä¸å¹‚ç­‰çš„åœºæ™¯ï¼Œä¾‹å¦‚æ³¨å†Œã€‚

-----------



## è°ˆä¸€è°ˆä½ å¯¹URLç†è§£

ç»Ÿä¸€èµ„æºå®šä½ç¬¦çš„ç®€ç§°ï¼ŒUniform Resource Locatorï¼Œå¸¸å¸¸è¢«ç§°ä¸ºç½‘å€ï¼Œæ˜¯å› ç‰¹ç½‘ä¸Šæ ‡å‡†çš„èµ„æºåœ°å€ã€‚

### ç»„æˆ

é€šç”¨çš„æ ¼å¼ï¼šscheme://host[:port]/path/â€¦/?query#anchor



| åç§°         | åŠŸèƒ½                                                         |
| ------------ | :----------------------------------------------------------- |
| scheme       | è®¿é—®æœåŠ¡å™¨ä»¥è·å–èµ„æºæ—¶è¦ä½¿ç”¨å“ªç§åè®®ï¼Œæ¯”å¦‚ï¼šhttpï¼Œhttps å’Œ FTP ç­‰ |
| host         | HTTP æœåŠ¡å™¨çš„ IP åœ°å€æˆ–è€…åŸŸå                                |
| port         | HTTP æœåŠ¡å™¨çš„é»˜è®¤ç«¯å£æ˜¯ 80ï¼ŒHTTPSé»˜è®¤ç«¯å£æ˜¯443ï¼Œè¿™ç§æƒ…å†µä¸‹ç«¯å£å·å¯ä»¥çœç•¥ï¼Œå¦‚æœä½¿ç”¨äº†åˆ«çš„ç«¯å£ï¼Œå¿…é¡»æŒ‡æ˜ã€‚ä¸åŒçš„ç«¯å£ï¼Œä½ å¯ä»¥è®¤ä¸ºæ˜¯ä¸åŒçš„åº”ç”¨ç¨‹åºã€‚ |
| path         | è®¿é—®èµ„æºçš„è·¯å¾„                                               |
| query-string | å‘ç»™ http æœåŠ¡å™¨çš„æ•°æ®                                       |
| anchor       | é”šç‚¹                                                         |

ä¸¾ä¸ªä¾‹å­ğŸ‘‡

```
https://www.baidu.com/s?tn=baidu&bar=&wd=TianTian
```

è¿™ä¸ªURLä¸­ï¼Œhttpså°±æ˜¯åè®®ï¼Œwww.baidu.comå°±æ˜¯åŸŸåï¼Œé»˜è®¤ç«¯å£æ˜¯443ï¼Œ/så°±æ˜¯è¯·æ±‚çš„pathï¼Œ`tn=baidu&bar=&wd=TianTian`è¿™ä¸ªå°±æ˜¯query



### URL ç¼–ç 

- URL åªèƒ½ä½¿ç”¨ [ASCII å­—ç¬¦é›†](https://www.w3school.com.cn/tags/html_ref_ascii.asp)æ¥é€šè¿‡å› ç‰¹ç½‘è¿›è¡Œå‘é€ã€‚
- ç”±äº URL å¸¸å¸¸ä¼šåŒ…å« ASCII é›†åˆä¹‹å¤–çš„å­—ç¬¦ï¼ŒURL å¿…é¡»è½¬æ¢ä¸ºæœ‰æ•ˆçš„ ASCII æ ¼å¼ã€‚
- URL ç¼–ç ä½¿ç”¨ "%" å…¶åè·Ÿéšä¸¤ä½çš„åå…­è¿›åˆ¶æ•°æ¥æ›¿æ¢é ASCII å­—ç¬¦ã€‚
- URL ä¸èƒ½åŒ…å«ç©ºæ ¼ã€‚URL ç¼–ç é€šå¸¸ä½¿ç”¨ + æ¥æ›¿æ¢ç©ºæ ¼ã€‚

ä¸¾ä¸ªä¾‹å­ğŸ‘‡

`å¤©å¤©`è½¬æ¢ä¸ºæœ‰æ•ˆçš„ASCIIæ ¼å¼å°±æ˜¯`%CC%EC%CC%EC`



-------



## å¯¹Acceptç³»åˆ—å­—æ®µç†è§£









------------





## è°ˆä¸€è°ˆHTTPä»£ç†





----------



## è°ˆä¸€è°ˆé˜Ÿå¤´é˜»å¡é—®é¢˜

### ä»€ä¹ˆæ˜¯é˜Ÿå¤´é˜»å¡ï¼Ÿ

å¯¹äºæ¯ä¸€ä¸ªHTTPè¯·æ±‚è€Œè¨€ï¼Œè¿™äº›ä»»åŠ¡æ˜¯ä¼šè¢«æ”¾å…¥ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ä¸²è¡Œæ‰§è¡Œçš„ï¼Œä¸€æ—¦é˜Ÿé¦–ä»»åŠ¡è¯·æ±‚å¤ªæ…¢æ—¶ï¼Œå°±ä¼šé˜»å¡åé¢çš„è¯·æ±‚å¤„ç†ï¼Œè¿™å°±æ˜¯`HTTPé˜Ÿå¤´é˜»å¡`é—®é¢˜ã€‚

æœ‰ä»€ä¹ˆè§£å†³åŠæ³•å—ğŸ‘‡

### å¹¶å‘è¿æ¥

æˆ‘ä»¬çŸ¥é“å¯¹äºä¸€ä¸ªåŸŸåè€Œè¨€ï¼Œæ˜¯å…è®¸åˆ†é…å¤šä¸ªé•¿è¿æ¥çš„ï¼Œé‚£ä¹ˆå¯ä»¥ç†è§£æˆå¢åŠ äº†ä»»åŠ¡é˜Ÿåˆ—ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸ä¼šå¯¼è‡´ä¸€ä¸ªä»»åŠ¡é˜»å¡äº†è¯¥ä»»åŠ¡é˜Ÿåˆ—çš„å…¶ä»–ä»»åŠ¡ï¼Œåœ¨`RFCè§„èŒƒ`ä¸­è§„å®šå®¢æˆ·ç«¯æœ€å¤šå¹¶å‘2ä¸ªè¿æ¥ï¼Œä¸è¿‡å®é™…æƒ…å†µå°±æ˜¯è¦æ¯”è¿™ä¸ªè¿˜è¦å¤šï¼Œä¸¾ä¸ªä¾‹å­ï¼ŒChromeä¸­æ˜¯6ä¸ªã€‚



### åŸŸååˆ†ç‰‡

é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªåŸŸåä¸‹åˆ†å‡ºå¤šä¸ªäºŒçº§åŸŸåå‡ºæ¥ï¼Œè€Œå®ƒä»¬æœ€ç»ˆæŒ‡å‘çš„è¿˜æ˜¯åŒä¸€ä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·å­çš„è¯å°±å¯ä»¥å¹¶å‘å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—æ›´å¤šï¼Œä¹Ÿæ›´å¥½çš„è§£å†³äº†é˜Ÿå¤´é˜»å¡çš„é—®é¢˜ã€‚

ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚`TianTian.com`ï¼Œå¯ä»¥åˆ†å‡ºå¾ˆå¤šäºŒçº§åŸŸåï¼Œæ¯”å¦‚`Day1.TianTian.com`ï¼Œ`Day2.TianTian.com`,`Day3.TianTian.com`,è¿™æ ·å­å°±å¯ä»¥æœ‰æ•ˆè§£å†³é˜Ÿå¤´é˜»å¡é—®é¢˜ã€‚





------





## è°ˆä¸€è°ˆHTTPæ•°æ®ä¼ è¾“

å¤§æ¦‚é‡åˆ°çš„æƒ…å†µå°±åˆ†ä¸º**å®šé•¿æ•°æ®** ä¸ **ä¸å®šé•¿æ•°æ®**çš„å¤„ç†å§ã€‚

### å®šé•¿æ•°æ®

å¯¹äºå®šé•¿çš„æ•°æ®åŒ…è€Œè¨€ï¼Œå‘é€ç«¯åœ¨å‘é€æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦è®¾ç½®`Content-Length`,æ¥æŒ‡æ˜å‘é€æ•°æ®çš„é•¿åº¦ã€‚

å½“ç„¶äº†å¦‚æœé‡‡ç”¨äº†Gzipå‹ç¼©çš„è¯ï¼ŒContent-Lengthè®¾ç½®çš„å°±æ˜¯å‹ç¼©åçš„ä¼ è¾“é•¿åº¦ã€‚

æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“çš„æ˜¯ğŸ‘‡

- Content-Lengthå¦‚æœå­˜åœ¨å¹¶ä¸”æœ‰æ•ˆçš„è¯ï¼Œåˆ™å¿…é¡»å’Œæ¶ˆæ¯å†…å®¹çš„ä¼ è¾“é•¿åº¦å®Œå…¨ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœè¿‡çŸ­å°±ä¼šæˆªæ–­ï¼Œè¿‡é•¿çš„è¯ï¼Œå°±ä¼šå¯¼è‡´è¶…æ—¶ã€‚
- å¦‚æœé‡‡ç”¨çŸ­é“¾æ¥çš„è¯ï¼Œç›´æ¥å¯ä»¥é€šè¿‡æœåŠ¡å™¨å…³é—­è¿æ¥æ¥ç¡®å®šæ¶ˆæ¯çš„ä¼ è¾“é•¿åº¦ã€‚
- é‚£ä¹ˆåœ¨HTTP/1.0ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ŒContent-Lengthå­—æ®µå¯æœ‰å¯æ— ,å› ä¸ºä¸€æ—¦æœåŠ¡å™¨å…³é—­è¿æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥è·å–åˆ°ä¼ è¾“æ•°æ®çš„é•¿åº¦äº†ã€‚
- åœ¨HTTP/1.1ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœæ˜¯Keep-aliveçš„è¯ï¼Œchunkedä¼˜å…ˆçº§é«˜äº`Content-Length`,è‹¥æ˜¯éKeep-aliveï¼Œè·Ÿå‰é¢æƒ…å†µä¸€æ ·ï¼ŒContent-Lengthå¯æœ‰å¯æ— ã€‚

é‚£æ€ä¹ˆæ¥è®¾ç½®`Content-Length`

ä¸¾ä¸ªä¾‹å­æ¥çœ‹çœ‹ğŸ‘‡

```

const server = require('http').createServer();
server.on('request', (req, res) => {
  if(req.url === '/index') {
  	// è®¾ç½®æ•°æ®ç±»å‹
    res.setHeader('Content-Type', 'text/plain');
    res.setHeader('Content-Length', 10);
    res.write("ä½ å¥½ï¼Œä½¿ç”¨çš„æ˜¯Content-Lengthè®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼");
  }
})

server.listen(3000, () => {
  console.log("æˆåŠŸå¯åŠ¨--TinaTian");
})

```





### ä¸å®šé•¿æ•°æ®

ç°åœ¨é‡‡ç”¨æœ€å¤šçš„å°±æ˜¯HTTP/1.1ç‰ˆæœ¬ï¼Œæ¥å®Œæˆä¼ è¾“æ•°æ®ï¼Œåœ¨ä¿å­˜Keep-aliveçŠ¶æ€ä¸‹ï¼Œå½“æ•°æ®æ˜¯ä¸å®šé•¿çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®æ–°çš„å¤´éƒ¨å­—æ®µğŸ‘‡

```
Transfer-Encoding: chunked
```

é€šè¿‡chunkedæœºåˆ¶ï¼Œå¯ä»¥å®Œæˆå¯¹ä¸å®šé•¿æ•°æ®çš„å¤„ç†ï¼Œå½“ç„¶äº†ï¼Œä½ éœ€è¦çŸ¥é“çš„æ˜¯

- å¦‚æœå¤´éƒ¨ä¿¡æ¯ä¸­æœ‰`Transfer-Encoding`,ä¼˜å…ˆé‡‡ç”¨Transfer-Encodingé‡Œé¢çš„æ–¹æ³•æ¥æ‰¾åˆ°å¯¹åº”çš„é•¿åº¦ã€‚
- å¦‚æœè®¾ç½®äº†Transfer-Encodingï¼Œé‚£ä¹ˆContent-Lengthå°†è¢«å¿½è§†ã€‚
- ä½¿ç”¨é•¿è¿æ¥çš„è¯ï¼Œä¼šæŒç»­çš„æ¨é€åŠ¨æ€å†…å®¹ã€‚



é‚£æˆ‘ä»¬æ¥æ¨¡æ‹Ÿä¸€ä¸‹å§ğŸ‘‡



```
const server = require('http').createServer();
server.on('request', (req, res) => {
  if(req.url === '/index') {
  	// è®¾ç½®æ•°æ®ç±»å‹
    res.setHeader('Content-Type', 'text/html; charset=utf8');
    res.setHeader('Content-Length', 10);
    res.setHeader('Transfer-Encoding', 'chunked');
    
    res.write("ä½ å¥½ï¼Œä½¿ç”¨çš„æ˜¯Transfer-Encodingè®¾ç½®ä¼ è¾“æ•°æ®å½¢å¼");
    setTimeout(() => {
      res.write("ç¬¬ä¸€æ¬¡ä¼ è¾“æ•°æ®ç»™æ‚¨<br/>");
    }, 1000);
    res.write("éªšç­‰ä¸€ä¸‹");
    setTimeout(() => {
      res.write("ç¬¬ä¸€æ¬¡ä¼ è¾“æ•°æ®ç»™æ‚¨");
      res.end()
    }, 3000);
  }
})

server.listen(3000, () => {
  console.log("æˆåŠŸå¯åŠ¨--TinaTian");
})

```



ä¸Šé¢ä½¿ç”¨çš„æ˜¯nodejsä¸­httpæ¨¡å—ï¼Œæœ‰å…´è¶£çš„å°ä¼™ä¼´å¯ä»¥å»è¯•ä¸€è¯•ï¼Œä»¥ä¸Šå°±æ˜¯HTTPå¯¹**å®šé•¿æ•°æ®**å’Œ**ä¸å®šé•¿æ•°æ®**ä¼ è¾“è¿‡ç¨‹ä¸­çš„å¤„ç†æ‰‹æ®µã€‚





-------------









## ä»‹ç»ä¸€ä¸‹HTTPSå’ŒHTTPåŒºåˆ«





## ä»‹ç»ä¸€ä¸ªHTTPSå·¥ä½œåŸç†







-------







## å‚è€ƒ

- [å¬è¯´ã€99% çš„äººéƒ½ç†è§£é”™äº† HTTP ä¸­ GET ä¸ POST çš„åŒºåˆ«ã€ï¼Ÿï¼Ÿ](https://zhuanlan.zhihu.com/p/25028045)
- [å¦‚ä½•ç†è§£HTTPå“åº”çš„çŠ¶æ€ç ï¼Ÿ](https://harttle.land/2015/08/15/http-status-code.html#header-11)
- [HTTP å“åº”ä»£ç  | MDN](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Status)
- [å›¾è§£ HTTP ç¼“å­˜](https://juejin.im/post/5eb7f811f265da7bbc7cc5bd)
- [çœ‹å®Œè¿™ç¯‡HTTPï¼Œè·Ÿé¢è¯•å®˜æ‰¯çš®å°±æ²¡é—®é¢˜äº†](https://juejin.im/post/5e1870736fb9a02fef3a5dcb#heading-40)
- [HTTP keep-alive äºŒä¸‰äº‹](https://lotabout.me/2019/Things-about-keepalive/)